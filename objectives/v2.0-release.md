# 마일스톤 v2.0: 전 기능 완성 릴리스

## 목표

v0.1~v0.10에서 설계한 모든 기능이 구현, 테스트, 문서화되어 공개 릴리스 가능한 상태.

---

## 구현 대상 설계 문서

v2.0은 새로운 설계 문서를 구현하는 것이 아니라, **v1.1~v1.7에서 구현한 모든 설계 문서(30개)의 최종 검증과 릴리스 준비**를 수행한다.

### 설계 문서 구현 완료 확인 매핑

| 문서 | 이름 | 구현 마일스톤 | v2.0 최종 검증 범위 |
|------|------|-------------|-------------------|
| 24 | monorepo-data-directory | v1.1 | 7-pkg 모노레포 구조 + ~/.waiaas/ 디렉토리 + config.toml 평탄화 17키 최종 확인 |
| 25 | sqlite-schema | v1.1 | 7 테이블 + Drizzle ORM + UUID v7 + CHECK 제약 + batch_items 정규화 최종 확인 |
| 26 | keystore-spec | v1.1 | AES-256-GCM + Argon2id + sodium guarded memory + 파일 권한 0600 최종 확인 |
| 27 | chain-adapter-interface | v1.1 (기본) -> v1.4 (전체) | IChainAdapter 20 메서드 전수 구현 + SolanaAdapter + EvmAdapter 최종 확인 |
| 28 | daemon-lifecycle-cli | v1.1 | 6단계 시작 + 10-step 종료 + 타임아웃 fail-fast/soft 최종 확인 |
| 29 | api-framework-design | v1.1 (골격) -> v1.2 (전체) | Hono + 8 미들웨어 + localhost 보안 + 66 에러 코드 매핑 최종 확인 |
| 30 | session-token-protocol | v1.2 | JWT HS256 + SIWS/SIWE + SessionConstraints + 낙관적 갱신 + token_hash CAS 최종 확인 |
| 31 | solana-adapter-detail | v1.1 (SOL) -> v1.4 (SPL/컨트랙트) | SolanaAdapter 전체 구현 + @solana/kit 3.x + 파이프 빌드 최종 확인 |
| 32 | transaction-pipeline-api | v1.1 (골격) -> v1.2 (전체) | 6-stage 파이프라인 + 8-state 머신 + Stage 5 완전 의사코드(CONC-01) 최종 확인 |
| 33 | time-lock-approval-mechanism | v1.2 | DatabasePolicyEngine + 4-tier + TOCTOU + APPROVAL 타임아웃 3단계 우선순위 최종 확인 |
| 34 | owner-wallet-connection | v1.2 | ownerAuth + Owner API + Owner 3-State(NONE/GRACE/LOCKED) 최종 확인 |
| 35 | notification-architecture | v1.3 | INotificationChannel + 3채널(Telegram/Discord/ntfy) + 17 이벤트 최종 확인 |
| 36 | killswitch-autostop-evm | v1.4 (EVM) + v1.6 (KillSwitch) | Kill Switch 3-state + 6-step cascade + AutoStop 5규칙 + 4전이 CAS ACID 최종 확인 |
| 37 | rest-api-complete-spec | v1.1 (기본) -> v1.3 (전체) | 38 엔드포인트 전수 + 66 에러 코드 + OpenAPI 3.0 유효성 최종 확인 |
| 38 | sdk-mcp-interface | v1.3 | TS SDK + Python SDK + MCP 6 도구 + 3 리소스 + SessionManager 최종 확인 |
| 39 | tauri-desktop-architecture | v1.6 | Tauri 2 + Sidecar SEA + 8 화면 + 시스템 트레이 + WalletConnect 최종 확인 |
| 40 | telegram-bot-docker | v1.6 | Telegram Bot Long Polling + 2-Tier auth + Docker compose 최종 확인 |
| 45 | enum-unified-mapping | v1.1 | 12 Enum SSoT + PolicyType 10개 + 빌드타임 4단계 방어 최종 확인 |
| 46 | keystore-external-security-scenarios | v1.7 | SEC-04 10건 보안 시나리오 전수 통과 최종 확인 |
| 47 | boundary-value-chain-scenarios | v1.7 | SEC-05 경계값 19건 + 연쇄 공격 체인 5건 전수 통과 최종 확인 |
| 48 | blockchain-test-environment-strategy | v1.7 | 3단계 환경 + Mock RPC 13건 + Local Validator 5 E2E + Devnet 3건 최종 확인 |
| 49 | enum-config-consistency-verification | v1.7 | 9개 Enum SSoT 빌드타임 검증 + config.toml 12건 + NOTE 매핑 최종 확인 |
| 50 | cicd-pipeline-coverage-gate | v1.7 | 4-stage CI/CD + Soft/Hard 게이트 + 4개 YAML 동작 최종 확인 |
| 51 | platform-test-scope | v1.7 | CLI 32 + Docker 18 + Tauri 34 + Telegram 34 = 118건 전수 통과 최종 확인 |
| 52 | auth-model-redesign | v1.2 | 3-tier 인증(master/owner/session) + owner_address 에이전트별 최종 확인 |
| 53 | session-renewal-protocol | v1.2 | 낙관적 갱신 + 5종 안전 장치 + RENEWAL_CONFLICT 409 최종 확인 |
| 54 | cli-flow-redesign | v1.1 | CLI SSoT + --quickstart + --dev 모드 최종 확인 |
| 55 | dx-improvement-spec | v1.3 | hint 31/40 + MCP DX + 원격 접근 가이드 최종 확인 |
| 56 | token-transfer-extension | v1.4 | SPL/ERC-20 토큰 전송 + ALLOWED_TOKENS 정책 최종 확인 |
| 57 | asset-query-fee-estimation | v1.4 | getAssets() + 수수료 추정(SPL ATA/ERC-20 gas) 최종 확인 |
| 58 | contract-call-spec | v1.4 | ContractCallRequest + CONTRACT_WHITELIST + METHOD_WHITELIST 최종 확인 |
| 59 | approve-management-spec | v1.4 | ApproveRequest + 3 approve 정책 최종 확인 |
| 60 | batch-transaction-spec | v1.4 | BatchRequest + Solana 원자적 배치 + batch_items 정규화 최종 확인 |
| 61 | price-oracle-spec | v1.5 | IPriceOracle + OracleChain + 5분 TTL + 가격 나이 3단계 최종 확인 |
| 62 | action-provider-architecture | v1.5 | IActionProvider + ActionProviderRegistry + MCP Tool 변환 최종 확인 |
| 63 | swap-action-spec | v1.5 | Jupiter Swap + 슬리피지/MEV 보호 최종 확인 |
| 64 | extension-test-strategy | v1.7 | 166 시나리오 + Mock 10경계 + Contract Test 7 전수 통과 최종 확인 |

### 최종 검증 기준

v2.0 최종 검증은 다음 기준으로 수행한다:

1. **각 설계 문서의 구현 범위가 해당 마일스톤 objective에 명시된 범위와 일치하는가**
2. **해당 마일스톤의 E2E 검증 시나리오가 모두 통과하는가**
3. **설계 문서에 `> [vX.Y 구현 중 변경]` 주석이 있는 경우, 변경 내용이 반영되었는가**
4. **설계 부채(design-debt.md)에 미해결 항목이 0건인가 (또는 v2.1 이연 명시)**

---

## 산출물

### 1. 코드

8 패키지 전체 구현 완료 확인:

| 패키지 | 기능 | 구현 마일스톤 |
|--------|------|-------------|
| `@waiaas/core` | Zod 스키마, 타입, Enum SSoT, 66 에러 코드, 인터페이스 | v1.1 |
| `@waiaas/daemon` | Hono 서버, SQLite+Drizzle, Keystore, Pipeline, PolicyEngine, Kill Switch | v1.1~v1.6 |
| `@waiaas/adapter-solana` | SolanaAdapter 20 메서드, @solana/kit 3.x | v1.1~v1.4 |
| `@waiaas/adapter-evm` | EvmAdapter 20 메서드, viem 2.x, EIP-1559 | v1.4 |
| `@waiaas/sdk` | TypeScript SDK, 0 외부 의존성, WAIaaSClient 클래스 | v1.3 |
| `@waiaas/mcp` | MCP Server, 6 도구 + 3 리소스, SessionManager | v1.3 |
| `@waiaas/cli` | waiaas init/start/stop/status, --quickstart, --dev | v1.1 |
| `@waiaas/skills` | API 스킬 파일 배포 CLI (`npx @waiaas/skills add <name>`) | v2.0 |

추가 컴포넌트:
- Tauri Desktop App: Tauri 2 + React 18 + TailwindCSS 4, 8 화면, Sidecar SEA (v1.6)
- Telegram Bot: Long Polling, 2-Tier auth, 인라인 키보드 (v1.6)
- Python SDK: httpx + Pydantic v2, pip 패키지 (v1.3)

### 2. 테스트

| 항목 | 기준 | 검증 방법 |
|------|------|----------|
| 커버리지 | Hard 80% 게이트 통과 | CI coverage-gate.sh hard 모드 자동 판정 |
| 보안 시나리오 | 237건 전수 통과 | Vitest test:security 자동 실행 |
| 플랫폼 테스트 | 118건 전수 통과 | release.yml platform-cli + platform-docker |
| 확장 기능 테스트 | ~148건 시나리오 통과 | Vitest test:unit + test:integration |
| Contract Test | 7개 인터페이스 동일성 검증 | Mock <-> 실제 구현체 비교 assert |
| Enum SSoT | 9개 Enum 빌드타임 검증 통과 | tsc --noEmit + Enum 테스트 |
| 블록체인 통합 | Local Validator 5 E2E + Anvil 통합 통과 | nightly.yml chain-tests |

### 3. 문서

#### 3.1 문서 디렉토리 재편성

오픈소스 공개 전 문서 구조를 사용자 중심으로 재편성한다:

| 변경 | 내용 |
|------|------|
| `docs/` → `docs-internal/` | 기존 설계 문서(24~72)를 내부 문서 디렉토리로 이동 |
| `why-waiaas/` → `docs/why-waiaas/` | 프로젝트 가치 설명 문서를 사용자 문서로 이동 |
| `docs/` (신규) | 사용자용 문서만 포함: API 레퍼런스, 배포 가이드, 기여 가이드, why-waiaas 등 |

재편성 후 `docs/` 구조:

```
docs/
  api-reference/          # OpenAPI 3.0 스펙
  guides/                 # 배포 가이드, 마이그레이션 가이드
  why-waiaas/             # 프로젝트 가치 설명 (영문, 오픈소스 사용자 대상)
  api-versioning.md       # API 버저닝 정책
```

#### 3.2 산출물

| 문서 | 내용 | 생성 방식 |
|------|------|----------|
| API 레퍼런스 | OpenAPI 3.0 스펙 (38 엔드포인트, 66 에러 코드) | Hono 라우트에서 자동 생성 + 수동 보완 |
| 배포 가이드 | CLI 설치 (npm global), Docker 설치 (compose), Desktop 설치 (GitHub Release) | 수동 작성 |
| 기여 가이드 | CONTRIBUTING.md -- 개발 환경 설정, 코드 스타일, PR 프로세스, 테스트 실행 방법 | 수동 작성 |
| README | 프로젝트 소개, 빠른 시작(Quick Start), 아키텍처 개요, 라이선스 | 수동 작성 (영문 기본) |
| CHANGELOG | v1.1~v2.0 전체 변경 이력 | Keep a Changelog 포맷 또는 Conventional Commits 자동 생성 |
| Why WAIaaS | AI 에이전트 지갑 보안 위기, 지갑 모델 비교 등 프로젝트 가치 설명 (영문) | 수동 작성 (why-waiaas/ 폴더에 축적) |

### 4. 배포

**npm 패키지:**

| 패키지 | 공개/비공개 | 비고 |
|--------|-----------|------|
| `@waiaas/core` | 공개 | AI 에이전트 통합에 필요한 타입/스키마 |
| `@waiaas/sdk` | 공개 | AI 에이전트가 직접 사용하는 SDK |
| `@waiaas/mcp` | 공개 | MCP 서버 패키지 |
| `@waiaas/daemon` | 공개 | 데몬 서버 (self-hosted 설치) |
| `@waiaas/cli` | 공개 | CLI 도구 (npm global install) |
| `@waiaas/adapter-solana` | 공개 | Solana 어댑터 |
| `@waiaas/adapter-evm` | 공개 | EVM 어댑터 |
| `@waiaas/skills` | 공개 | API 스킬 파일 배포 (`npx @waiaas/skills add <name>`) |

**Docker 이미지:**
- `waiaas/daemon:latest` + `waiaas/daemon:2.0.0` (semver 태그)
- Multi-stage Dockerfile, non-root UID 1001, named volume
- Docker Hub push

**Desktop 바이너리 (5 플랫폼):**
- macOS ARM64 (.dmg) + macOS x64 (.dmg)
- Windows x64 (.msi)
- Linux x64 (.AppImage) + Linux ARM64 (.AppImage)
- GitHub Release 첨부

### 5. 예제 에이전트

SDK 사용법을 보여주는 레퍼런스 코드. 외부 개발자가 참고할 수 있는 최소 동작 예제.

```
examples/
  simple-agent/
    index.ts              # @waiaas/sdk 기반 간단한 에이전트 (잔액 조회 → 조건부 전송 → 완료 대기)
    README.md             # 실행 방법, 사전 조건, 예상 출력
    package.json          # @waiaas/sdk 의존성만
```

| 항목 | 내용 |
|------|------|
| 언어 | TypeScript (tsx/ts-node 실행) |
| 의존성 | `@waiaas/sdk`만 (0 외부 의존성 SDK의 장점 부각) |
| 시나리오 | 잔액 조회 → 임계값 비교 → 조건부 SOL 전송 → 트랜잭션 완료 대기 → 결과 출력 |
| 용도 | README Quick Start 참조, npm 패키지 페이지 예제, 홍보 데모 소재 |
| LLM 불필요 | 확정적 코드 흐름 — AI API 키 없이 `node` 또는 `tsx`로 즉시 실행 가능 |

### 6. 릴리스

| 항목 | 내용 |
|------|------|
| GitHub Release | v2.0.0 태그, 릴리스 노트, 5 플랫폼 바이너리 첨부 |
| CHANGELOG.md | v1.1~v2.0 전체 변경 이력 (Keep a Changelog 포맷) |
| 마이그레이션 가이드 | 해당 없음 -- 첫 공개 릴리스이므로 이전 버전에서의 마이그레이션 불필요 |

---

## 기술 결정 사항

| # | 결정 항목 | 선택지 | 결정 근거 |
|---|----------|--------|----------|
| 1 | npm publish 범위 | 전체 8 패키지 공개 | Self-hosted 아키텍처이므로 모든 패키지가 npm에서 직접 설치 가능해야 함. @waiaas/skills는 AI 에이전트가 스킬 파일을 즉시 사용할 수 있도록 배포. 비공개 패키지는 관리 복잡도만 증가 |
| 2 | Docker 이미지 태깅 전략 | latest + semver (2.0.0) + git SHA | latest는 편의성, semver는 고정 버전 배포, SHA는 디버깅용 정확한 빌드 추적 |
| 3 | GitHub Release 자동화 | release-please | Conventional Commits 기반 자동 버전 범프 + CHANGELOG 생성. 수동 태그 대비 일관성 확보 |
| 4 | README 언어 | 영문 기본 + README.ko.md 한글 버전 | 오픈소스 공개를 위해 영문 기본. 한국어 사용자를 위한 별도 한글 버전 제공 |
| 5 | 라이선스 | MIT | 가장 관대한 라이선스. AI 에이전트 생태계 통합에 제약 최소화. Apache 2.0은 특허 조항이 과도 |
| 6 | 문서 호스팅 | GitHub Pages | 초기 릴리스에서 별도 문서 사이트 부담 회피. OpenAPI 스펙은 Swagger UI로 자동 렌더링 |
| 7 | CHANGELOG 포맷 | Keep a Changelog + release-please 자동 생성 | Keep a Changelog의 가독성 + Conventional Commits의 자동화를 결합 |

---

## E2E 검증 시나리오

**릴리스 체크리스트 통합 -- `[HUMAN]` 3건**

### 자동 검증 (CI/스크립트)

| # | 시나리오 | 검증 방법 | 태그 |
|---|---------|----------|------|
| 1 | CI/CD nightly 3일 연속 통과 확인 | nightly.yml 실행 이력 3일 연속 success 확인 (GitHub API 또는 수동 확인) | [L0] |
| 2 | 보안 시나리오 237건 전수 통과 | Vitest test:security 전수 실행 -> 0 failures assert | [L0] |
| 3 | 커버리지 Hard 80% 게이트 통과 | coverage-gate.sh hard 모드 -> exit 0 | [L0] |
| 4 | Enum SSoT 빌드타임 검증 통과 | tsc --noEmit + Enum round-trip 테스트 전수 통과 | [L0] |
| 5 | 플랫폼 테스트 118건 전수 통과 | release.yml platform-cli(32건) + platform-docker(18건) + Telegram(34건) + Tauri 자동(6건) = 90건 자동 통과 + QA 28건 별도 | [L0] |
| 6 | npm publish --dry-run 성공 (공개 8 패키지) | 각 패키지 `npm publish --dry-run` exit 0 | [L1] |
| 7 | Docker Hub push 성공 | `docker push waiaas/daemon:2.0.0` + `docker push waiaas/daemon:latest` 성공 | [L1] |
| 8 | GitHub Release 생성 + 5 플랫폼 바이너리 첨부 | release-please 자동 생성 + release.yml matrix 빌드 아티팩트 첨부 확인 | [L1] |
| 9 | 설계 부채 0건 확인 (또는 v2.1 이연 명시) | `objectives/design-debt.md` 파일 파싱 -> 미해결 항목 0건 assert (또는 v2.1 이연 항목만 존재) | [L0] |
| 10 | 설계 문서 30개 구현 매핑 전수 확인 | 본 문서의 매핑 테이블 30개 행 x v2.0 최종 검증 범위 항목이 모두 "확인됨" 상태 | [L0] |
| 11 | OpenAPI 3.0 스펙 유효성 검증 | Swagger CLI validate 또는 OpenAPI 유효성 검증 도구 실행 -> 0 errors | [L0] |
| 12 | 예제 에이전트 실행 성공 | `tsx examples/simple-agent/index.ts` 실행 -> 잔액 조회 + 전송 + 완료 대기 정상 동작 (devnet/localnet) | [L1] |
| 13 | @waiaas/skills npx 설치 성공 | `npx @waiaas/skills add wallet transactions` 실행 -> 스킬 파일 복사 확인 | [L1] |

### 수동 검증 [HUMAN]

| # | 시나리오 | 검증 방법 | 태그 |
|---|---------|----------|------|
| 14 | README 영문 버전 내용 검토 + 품질 확인 | README.md 영문 버전 읽기 -> 프로젝트 소개/Quick Start/아키텍처 개요가 정확하고 이해하기 쉬운지 판단 | [HUMAN] |
| 15 | CHANGELOG.md 최종 검토 + 누락 확인 | CHANGELOG.md에 v1.1~v2.0 모든 주요 변경 사항이 누락 없이 기재되었는지 확인 | [HUMAN] |
| 16 | 설계 부채 이연 판단 (0건이 아닌 경우) | design-debt.md에 미해결 항목이 있을 경우, v2.1 이연이 적절한지 판단. 보안 관련 부채는 이연 불가 | [HUMAN] |

---

## 의존

| 의존 대상 | 이유 |
|----------|------|
| v1.7 (품질 강화 + CI/CD) | v1.7에서 구축한 CI/CD 파이프라인과 테스트 인프라가 릴리스 검증의 기반. 커버리지 Hard 80%, 보안 237건 전수, 4-stage 파이프라인이 모두 동작해야 v2.0 릴리스 판정 가능 |

---

## 리스크

| # | 리스크 | 영향 | 대응 방안 |
|---|--------|------|----------|
| 1 | 설계 부채 잔존 | v2.0 전 0건 달성 목표이나, 구현 중 발견된 Tier 1~2 부채가 누적 시 릴리스 지연 | 매 마일스톤 시작 시 설계 부채 리뷰 의무화. Tier 3은 즉시 처리, Tier 1~2는 다음 마일스톤 전 해소. 불가피한 경우 v2.1 이연 명시 |
| 2 | npm 패키지 네이밍 충돌 | @waiaas 스코프가 npm에서 이미 사용 중이면 패키지 발행 불가 | npm scope 사전 확보 (`npm init --scope=@waiaas`). 충돌 시 대안 스코프 검토 (@waiaas-dev 등) |
| 3 | Docker Hub 이미지 크기 | native addon(sodium-native, better-sqlite3) 포함 시 500MB+ 가능성 | Multi-stage Dockerfile로 빌드 레이어와 런타임 레이어 분리. Alpine 기반 이미지 + prebuildify 바이너리만 포함. 목표 200MB 이하 |
| 4 | 5 플랫폼 바이너리 호환성 | Node.js SEA + native addon 조합으로 일부 플랫폼에서 빌드 실패 또는 런타임 에러 가능 | v0.7 prebuildify 전략 활용. Linux ARM64는 cross-compile 별도 검증. 빌드 실패 플랫폼은 v2.0에서 제외하고 v2.1 이연 가능 |
| 5 | 문서 품질 | 자동 생성 OpenAPI 외 수동 문서(README, CHANGELOG, 가이드)는 [HUMAN] 검토 필수. 검토 시간 부족 시 문서 품질 저하 | [HUMAN] 항목을 3건으로 제한하여 검토 부담 최소화. 자동 생성 가능한 부분(OpenAPI, API 레퍼런스)은 최대한 자동화 |
| 6 | 릴리스 롤백 | npm unpublish는 24시간 이내에만 가능. Docker Hub는 태그 덮어쓰기 가능하나 latest 사용자에게 영향 | release-please의 pre-release(rc) 기능으로 v2.0.0-rc.1 먼저 발행. 3일 관찰 후 v2.0.0 정식 발행. Docker는 semver 태그 사용 권장 |

---

*최종 업데이트: 2026-02-14 @waiaas/skills npm 패키지 배포 추가 (공개 8패키지), 릴리스 체크리스트 16건(자동 13 + [HUMAN] 3)*
