---
phase: 64-infra-auth-security-design
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - docs/67-admin-web-ui-spec.md
autonomous: true

must_haves:
  truths:
    - "설계 문서 67에 Hono serveStatic SPA 서빙 설정이 /admin/* fallback, /admin/assets/* 정적 파일 경로, CSP 헤더 값, 캐시 정책(해시 immutable + index.html no-cache)으로 구체적으로 정의되어 있다"
    - "설계 문서 67에 packages/admin 디렉토리 레이아웃(src/ 구조 포함), Vite 6.x 빌드 설정(@preact/preset-vite), daemon/public/admin/ 복사 전략(시점, 방법, git 추적 여부)이 확정되어 있다"
    - "설계 문서 67에 config.toml [daemon] 섹션의 admin_ui(boolean, 기본 true)와 admin_timeout(초, 기본 900) 신규 키, WAIAAS_DAEMON_ADMIN_UI/WAIAAS_DAEMON_ADMIN_TIMEOUT 환경변수 오버라이드, admin_ui=false 시 /admin 404 동작이 명세되어 있다"
    - "설계 문서 67에 masterAuth 로그인 화면 흐름, X-Master-Password 헤더 검증, @preact/signals Auth Store 설계, 비활성 타임아웃(15분 기본, mousemove/keydown 리셋), 로그아웃 메모리 클리어, 401 리다이렉트가 설계되어 있다"
    - "설계 문서 67에 CSP 정책(script-src 'self'), 메모리 전용 비밀번호 보관(localStorage/cookie 금지), 민감 데이터 노출 금지, Docker 포트 포워딩 보안 고려사항이 문서화되어 있다"
  artifacts:
    - path: "docs/67-admin-web-ui-spec.md"
      provides: "Admin Web UI 설계 문서 섹션 1-7 (개요, 기술 스택, Hono 서빙, 패키지 구조, config 확장, 인증 흐름, 보안)"
      contains: "## 1. 개요"
  key_links:
    - from: "docs/67-admin-web-ui-spec.md 섹션 3 (Hono 서빙)"
      to: "packages/daemon/src/api/server.ts"
      via: "serveStatic 설정 참조"
      pattern: "serveStatic"
    - from: "docs/67-admin-web-ui-spec.md 섹션 5 (config.toml)"
      to: "packages/daemon/src/infrastructure/config/loader.ts"
      via: "DaemonConfigSchema 확장 참조"
      pattern: "admin_ui|admin_timeout"
    - from: "docs/67-admin-web-ui-spec.md 섹션 6 (인증 흐름)"
      to: "packages/daemon/src/api/middleware/master-auth.ts"
      via: "X-Master-Password 검증 참조"
      pattern: "X-Master-Password"
---

<objective>
Admin Web UI 설계 문서 67의 인프라/인증/보안 기반 섹션(1~7)을 작성하여, Phase 65 페이지 설계의 기반을 확립한다.

Purpose: v1.3.2 구현 착수에 필요한 SPA 서빙, 패키지 구조, config 확장, masterAuth 인증, 보안 제약을 설계 문서에 확정한다. 이 7개 섹션이 완료되면 Phase 65에서 5개 페이지 화면과 API 연동 패턴 설계를 진행할 수 있다.

Output: `docs/67-admin-web-ui-spec.md` (섹션 1~7)
</objective>

<execution_context>
@/Users/minho.yoo/.claude/get-shit-done/workflows/execute-plan.md
@/Users/minho.yoo/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# 기술 결정 + 설계 범위 참조 (objectives 문서)
@objectives/v1.3.1-admin-ui-design.md
@objectives/v1.3.2-admin-ui-impl.md

# 기존 코드베이스 참조 (설계 문서에서 참조해야 할 실제 코드)
@packages/daemon/src/api/server.ts
@packages/daemon/src/infrastructure/config/loader.ts
@packages/daemon/src/api/middleware/master-auth.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: 설계 문서 67 섹션 1-3 작성 (개요 + 기술 스택 + Hono 서빙)</name>
  <files>docs/67-admin-web-ui-spec.md</files>
  <action>
`docs/67-admin-web-ui-spec.md` 파일을 새로 생성하고, 섹션 1~3을 작성한다.

**섹션 1: 개요 + 포지셔닝**

objectives/v1.3.1-admin-ui-design.md 섹션 1의 테이블을 기반으로 작성:
- 목적: 개발자/관리자용 경량 관리 도구. Tauri Desktop(v1.6) 풀 GUI와 역할 구분 명시
- 접근 방식: `http://127.0.0.1:{port}/admin` — 데몬이 정적 파일 직접 서빙
- 대상 사용자: Self-Hosted 운영자, AI 에이전트 개발자, Docker 환경 관리자
- 비대상: 최종 사용자용 풀 대시보드(Tauri), 트랜잭션 전송/지갑 조회(SDK/MCP)
- 범위 외 명시: 트랜잭션 전송/이력/승인(sessionAuth/ownerAuth 필요), 지갑 잔액 조회(sessionAuth 필요), Owner 등록(SIWS/SIWE 서명 필요)은 Admin UI 범위 밖
- 5 페이지 목록 요약 테이블 (화면명 + 주요 기능 + API 1줄 요약)

**섹션 2: 기술 스택**

기술 결정 사항 #1~#9를 확정 테이블로 정리. objectives에서 이미 확정된 내용을 구체화:

| 항목 | 결정 | 버전 | 번들 크기 | 근거 |
|------|------|------|----------|------|
| SPA 프레임워크 | Preact | 10.x | ~3KB gzip | React 호환 API, hooks/signals, Vite 공식 플러그인 |
| 라우터 | preact-iso hash router | latest | ~1KB gzip | #/agents 등 해시 라우팅, 서버 설정 불필요 |
| 상태 관리 | @preact/signals | latest | ~1KB gzip | Auth Store 전역 signal + 컴포넌트 로컬 상태 |
| 빌드 도구 | Vite + @preact/preset-vite | 6.x | - | tree-shaking, 해시 파일명, HMR |
| 스타일 | Custom CSS + CSS Variables | - | 0KB 프레임워크 | 5 페이지에 CSS 프레임워크는 과도 |
| HTTP 클라이언트 | 내장 fetch API | - | 0KB | 외부 라이브러리 없음 |
| 번들 크기 목표 | 100KB 이하 (gzip) | - | - | Preact 5KB + 앱 코드 + CSS |
| 다국어 | 영문 단일 | - | - | 관리자 도구 |
| API 캐싱 | 없음 (매번 fetch) | - | - | 항상 최신 데이터 필요 |

**섹션 3: Hono 서빙 설정 (INFRA-01, INFRA-04)**

구체적인 Hono 서빙 설정을 의사코드 수준으로 작성:

3.1 경로 분리:
- SPA: `/admin/*` → 정적 파일 서빙
- API: `/v1/admin/*` → 기존 REST 엔드포인트 (충돌 없음)
- `/health` → 기존 health check (변경 없음)

3.2 Hono serveStatic 설정 의사코드:
```typescript
// admin_ui=true일 때만 등록
if (config.daemon.admin_ui) {
  // 정적 파일 서빙 (/admin/assets/*)
  app.use('/admin/assets/*', serveStatic({ root: './public' }));
  // SPA fallback (/admin, /admin/, /admin/anything)
  app.get('/admin', serveStatic({ path: './public/admin/index.html' }));
  app.get('/admin/*', serveStatic({ root: './public' }));
  app.get('/admin/*', serveStatic({ path: './public/admin/index.html' })); // fallback
}
// admin_ui=false → 미등록 → 404 자동
```

3.3 CSP 헤더 미들웨어:
- `/admin/*` 경로에만 적용
- Content-Security-Policy 값: `default-src 'none'; script-src 'self'; style-src 'self' 'unsafe-inline'; connect-src 'self'; img-src 'self' data:; font-src 'self'; base-uri 'self'; form-action 'self'`
- 'unsafe-inline'은 style-src에만 허용 (CSS-in-JS 미사용이지만 인라인 style 속성 가능)

3.4 캐시 정책:
- `/admin/assets/*` (Vite 해시 파일명): `Cache-Control: public, max-age=31536000, immutable`
- `/admin/index.html` (엔트리): `Cache-Control: no-cache, no-store, must-revalidate`

3.5 CORS:
- 불필요: 동일 origin에서 SPA와 API 모두 서빙되므로 CORS 설정 불필요

3.6 admin_ui=false 동작 (INFRA-04):
- `/admin/*` 경로 미등록 → Hono 기본 404 반환
- API 엔드포인트(`/v1/admin/*`)는 `admin_ui` 설정과 무관하게 항상 사용 가능

**작성 시 주의사항:**
- 모든 기획 문서는 한글로 작성
- 기존 server.ts의 미들웨어 등록 순서와 충돌하지 않는 위치에 정적 서빙 등록
- 의사코드는 실제 Hono 4.x serveStatic API를 참조하여 현실적으로 작성
- 각 항목에 근거(WHY)를 명시
  </action>
  <verify>
파일 `docs/67-admin-web-ui-spec.md`가 존재하고, 섹션 1("## 1."), 섹션 2("## 2."), 섹션 3("## 3.")이 포함되어 있는지 확인:
```bash
test -f docs/67-admin-web-ui-spec.md && grep -c "^## [123]\." docs/67-admin-web-ui-spec.md
```
출력이 3이면 성공.
  </verify>
  <done>
- 섹션 1에 목적/대상/비대상/범위 외/5페이지 요약이 포함됨
- 섹션 2에 9개 기술 결정 테이블이 포함됨
- 섹션 3에 serveStatic 의사코드, CSP 헤더 값, 캐시 정책, admin_ui=false 동작이 포함됨
  </done>
</task>

<task type="auto">
  <name>Task 2: 설계 문서 67 섹션 4-7 작성 (패키지 구조 + config 확장 + 인증 흐름 + 보안)</name>
  <files>docs/67-admin-web-ui-spec.md</files>
  <action>
`docs/67-admin-web-ui-spec.md`에 섹션 4~7을 추가한다.

**섹션 4: 패키지 구조 + 빌드 전략 (INFRA-02)**

4.1 packages/admin 디렉토리 레이아웃:
```
packages/admin/
  package.json                     # name: @waiaas/admin, private: true
  tsconfig.json                    # Preact JSX 설정
  vite.config.ts                   # Vite 6.x + @preact/preset-vite
  index.html                       # SPA 엔트리 포인트
  src/
    main.tsx                       # Preact render + 해시 라우터 초기화
    app.tsx                        # 루트 컴포넌트 (라우터 + auth guard)
    api/
      client.ts                    # fetch 래퍼 (X-Master-Password 자동 주입, 401 처리)
      endpoints.ts                 # API 엔드포인트 상수 + 응답 타입
    auth/
      login.tsx                    # 로그인 화면
      store.ts                     # @preact/signals auth signal + 비활성 타임아웃
    pages/
      dashboard.tsx                # Dashboard (30초 폴링)
      agents.tsx                   # Agents CRUD
      sessions.tsx                 # Sessions 관리
      policies.tsx                 # Policies 관리
      settings.tsx                 # Settings + Kill Switch
    components/
      layout.tsx                   # 사이드바 + 헤더 + 콘텐츠 레이아웃
      table.tsx                    # 재사용 테이블
      form.tsx                     # 재사용 폼 (입력, 셀렉트, 버튼)
      modal.tsx                    # 확인 다이얼로그
      toast.tsx                    # 성공/에러 토스트
      copy-button.tsx              # 클립보드 복사 버튼
      empty-state.tsx              # 데이터 0건 안내
    styles/
      global.css                   # CSS 변수 + 글로벌 스타일
    utils/
      error-messages.ts            # 68 에러 코드 → 영문 메시지 매핑
      format.ts                    # 날짜, 주소 포맷팅
```

4.2 package.json 핵심 설정:
- `name`: `@waiaas/admin`
- `private`: true (npm 배포하지 않음)
- `type`: `module`
- `scripts.build`: `vite build`
- `scripts.dev`: `vite` (HMR 개발 서버)
- `scripts.postbuild`: `cp -r dist/* ../daemon/public/admin/`
- devDependencies: preact, @preact/signals, preact-iso, vite, @preact/preset-vite, typescript
- 데몬 런타임 의존성: 0개 (빌드 산출물만 포함)

4.3 Vite 빌드 설정:
```typescript
// vite.config.ts
import { defineConfig } from 'vite';
import preact from '@preact/preset-vite';

export default defineConfig({
  plugins: [preact()],
  base: '/admin/',          // 모든 asset 경로에 /admin/ 접두사
  build: {
    outDir: 'dist',
    emptyDirBeforeWrite: true,
    target: 'es2022',       // 최신 브라우저만 지원
    minify: 'esbuild',
    rollupOptions: {
      output: {
        // 해시 파일명으로 캐시 무효화
        entryFileNames: 'assets/[name]-[hash].js',
        chunkFileNames: 'assets/[name]-[hash].js',
        assetFileNames: 'assets/[name]-[hash].[ext]',
      },
    },
  },
});
```

4.4 빌드 산출물 복사 전략:
- **시점**: `pnpm --filter @waiaas/admin build` 실행 시 postbuild 스크립트가 자동 실행
- **방법**: `cp -r dist/* ../daemon/public/admin/` (빌드 산출물 전체 복사)
- **git 추적**: `packages/daemon/public/admin/`는 `.gitignore`에 추가. 빌드 산출물은 git 추적하지 않음. CI에서 빌드 후 패키징
- **Turborepo 의존성**: `@waiaas/daemon`의 turbo.json에서 `@waiaas/admin#build`를 의존으로 선언하여 빌드 순서 보장

4.5 개발 워크플로우:
- `pnpm --filter @waiaas/admin dev`: Vite HMR 개발 서버 (port 5173)
- 개발 시 API 프록시: Vite proxy 설정으로 `/v1/*` → `http://127.0.0.1:3100/v1/*` 프록시
- 프로덕션: 빌드 산출물을 데몬이 직접 서빙

**섹션 5: config.toml 확장 (INFRA-03)**

5.1 신규 키 (daemon 섹션에 추가):

| 키 | 타입 | 기본값 | 범위 | 설명 |
|---|------|-------|------|------|
| `admin_ui` | boolean | `true` | - | Admin Web UI 활성화 여부 |
| `admin_timeout` | number (초) | `900` | 60~7200 | 비활성 타임아웃 (900초 = 15분) |

5.2 환경변수 오버라이드:
- `WAIAAS_DAEMON_ADMIN_UI=false` → `admin_ui = false`
- `WAIAAS_DAEMON_ADMIN_TIMEOUT=1800` → `admin_timeout = 1800` (30분)
- 기존 `applyEnvOverrides()` 로직을 그대로 활용 (WAIAAS_{SECTION}_{KEY} 패턴)

5.3 DaemonConfigSchema 확장 (Zod):
```typescript
daemon: z.object({
  // ... 기존 8개 키 유지 ...
  admin_ui: z.boolean().default(true),
  admin_timeout: z.number().int().min(60).max(7200).default(900),
}).default({}),
```

5.4 config.toml 예시:
```toml
[daemon]
port = 3100
admin_ui = true
admin_timeout = 900
```

5.5 admin_timeout 전달 방식:
- 서버가 `/admin/config.js` 엔드포인트로 `admin_timeout` 값을 제공하는 방식은 사용하지 않음 (추가 엔드포인트 회피)
- 대신 `GET /v1/admin/status` 응답에 `adminTimeout` 필드를 추가하여, 로그인 성공 시 SPA가 타임아웃 값을 읽어 Auth Store에 저장
- 로그인 전에는 기본값 15분(900초) 사용, 로그인 후 서버 설정값으로 갱신

**섹션 6: masterAuth 인증 흐름 (AUTH-01, AUTH-02)**

6.1 인증 모델:
- Admin UI는 masterAuth 전용. JWT 세션 미사용
- 마스터 비밀번호를 X-Master-Password 헤더로 매 요청 전송
- 서버 측: 기존 createMasterAuth 미들웨어가 Argon2id로 검증 (변경 없음)

6.2 Auth Store 설계 (@preact/signals):
```typescript
// auth/store.ts 설계
import { signal, computed } from '@preact/signals';

// 메모리 전용 — localStorage/cookie 저장 금지
export const masterPassword = signal<string | null>(null);
export const isAuthenticated = computed(() => masterPassword.value !== null);
export const adminTimeout = signal<number>(900); // 기본 15분, 서버에서 갱신

// 비활성 타임아웃 관리
let inactivityTimer: ReturnType<typeof setTimeout> | null = null;

export function resetInactivityTimer(): void {
  if (inactivityTimer) clearTimeout(inactivityTimer);
  if (!masterPassword.value) return;
  inactivityTimer = setTimeout(() => {
    logout(); // 타임아웃 → 메모리 클리어 → 리다이렉트
  }, adminTimeout.value * 1000);
}

export function login(password: string, serverTimeout?: number): void {
  masterPassword.value = password;
  if (serverTimeout) adminTimeout.value = serverTimeout;
  startInactivityTracking();
}

export function logout(): void {
  masterPassword.value = null;
  stopInactivityTracking();
  // 해시 라우터로 로그인 화면 이동
  window.location.hash = '#/login';
}

function startInactivityTracking(): void {
  resetInactivityTimer();
  document.addEventListener('mousemove', resetInactivityTimer);
  document.addEventListener('keydown', resetInactivityTimer);
  document.addEventListener('click', resetInactivityTimer);
}

function stopInactivityTracking(): void {
  if (inactivityTimer) clearTimeout(inactivityTimer);
  document.removeEventListener('mousemove', resetInactivityTimer);
  document.removeEventListener('keydown', resetInactivityTimer);
  document.removeEventListener('click', resetInactivityTimer);
}
```

6.3 로그인 흐름:
1. 사용자가 마스터 비밀번호 입력 → Submit
2. `GET /v1/admin/status` 호출 (X-Master-Password 헤더 포함)
3. 200 응답 → `login(password, response.adminTimeout)` → `#/dashboard`로 이동
4. 401 응답 → "Invalid master password" 에러 메시지 표시
5. 네트워크 에러 → "Cannot connect to daemon" 메시지 표시

6.4 API 호출 시 인증:
- fetch 래퍼(api/client.ts)가 모든 요청에 `X-Master-Password: {masterPassword.value}` 헤더 자동 주입
- 401 응답 시: `logout()` 호출 → 메모리 클리어 → `#/login` 리다이렉트

6.5 비활성 타임아웃 (AUTH-02):
- 기본값: 900초 (15분)
- config.toml `admin_timeout`으로 조정 가능 (60~7200초)
- 추적 이벤트: mousemove, keydown, click
- 타임아웃 발생 시: `logout()` 호출 → 메모리 클리어 → `#/login` 이동
- 로그인 화면에서는 타이머 비활성

6.6 로그아웃:
- 헤더 로그아웃 버튼 클릭 → `logout()` → 메모리 클리어 + 타이머 해제 → `#/login`

6.7 Auth Guard (라우터 수준):
- `app.tsx`에서 `isAuthenticated`가 false이면 모든 라우트를 `#/login`으로 리다이렉트
- 로그인 화면은 인증 불필요

**섹션 7: 보안 고려사항 (SEC-01)**

7.1 localhost 전용 접근:
- 데몬이 기본 127.0.0.1에 바인딩 → 외부 네트워크 접근 차단
- hostGuard 미들웨어가 요청 Host 헤더 검증 (기존 구현)

7.2 Content-Security-Policy:
```
default-src 'none';
script-src 'self';
style-src 'self' 'unsafe-inline';
connect-src 'self';
img-src 'self' data:;
font-src 'self';
base-uri 'self';
form-action 'self'
```
- `script-src 'self'`: 인라인 스크립트, eval(), 외부 스크립트 차단
- `style-src 'unsafe-inline'`: Preact 인라인 style 속성 허용 (CSS-in-JS 미사용이지만 동적 스타일 가능)
- `connect-src 'self'`: 동일 origin API 호출만 허용

7.3 비밀번호 보관 정책:
- 메모리(JavaScript 변수)에만 보관
- localStorage, sessionStorage, cookie에 저장 금지
- 페이지 새로고침/닫기 시 자동 소실 → 재로그인 필요
- `masterPassword` signal이 유일한 보관 위치

7.4 민감 데이터 노출 금지:
- 개인 키(Private Key): UI에 절대 노출 금지. 에이전트 상세에서 publicKey(공개 키)만 표시
- 마스터 비밀번호 해시: API 응답에 포함되지 않음 (기존 구현)
- JWT 시크릿: rotate-secret 결과에 새 시크릿 미포함 (성공/실패만)
- 세션 토큰: 생성 시 1회만 표시, 이후 마스킹 처리

7.5 Docker 환경 보안 고려:
- Docker에서 포트 포워딩(`-p 3100:3100`) 시 외부 접근 가능
- 대응: masterAuth 인증이 필수이므로 비밀번호 없이 접근 불가
- 추가 권고: Docker 사용 시 `admin_ui = false` 설정 또는 방화벽으로 포트 제한
- `hostname = '0.0.0.0'` 설정 시 hostGuard가 외부 Host도 허용 → masterAuth가 유일한 방어선

7.6 XSS 방어:
- CSP `script-src 'self'`로 인라인/외부 스크립트 실행 차단
- Preact의 JSX 자동 이스케이프로 반사형 XSS 방어
- 사용자 입력(에이전트 이름 등)은 텍스트 노드로 렌더링, innerHTML 미사용

7.7 CSRF 방어:
- 브라우저 fetch API의 same-origin 요청 + 커스텀 헤더(X-Master-Password) 사용
- 커스텀 헤더는 simple request가 아니므로 CORS preflight 없이 cross-origin에서 전송 불가
- 추가 CSRF 토큰 불필요

**문서 끝에 추가:**
- Phase 65에서 작성할 섹션 예고: `## 8. 화면 설계`, `## 9. 공통 컴포넌트`, `## 10. API 연동 패턴`
- 관련 설계 문서 참조 테이블 (objectives 문서의 관련 문서 테이블 포함)
- 최종 업데이트 날짜
  </action>
  <verify>
섹션 4~7이 파일에 포함되어 있는지 확인:
```bash
grep -c "^## [4567]\." docs/67-admin-web-ui-spec.md
```
출력이 4이면 성공. 추가로 핵심 키워드 확인:
```bash
grep -q "admin_ui" docs/67-admin-web-ui-spec.md && grep -q "admin_timeout" docs/67-admin-web-ui-spec.md && grep -q "X-Master-Password" docs/67-admin-web-ui-spec.md && grep -q "script-src" docs/67-admin-web-ui-spec.md && echo "PASS"
```
  </verify>
  <done>
- 섹션 4에 packages/admin 디렉토리 레이아웃, Vite 설정, 빌드 복사 전략, git 추적 정책이 포함됨
- 섹션 5에 admin_ui/admin_timeout Zod 스키마, 환경변수 오버라이드, config.toml 예시가 포함됨
- 섹션 6에 Auth Store signal 설계, 로그인/로그아웃 흐름, 비활성 타임아웃, 401 리다이렉트, Auth Guard가 포함됨
- 섹션 7에 CSP 헤더 값, 메모리 전용 보관, 민감 데이터 노출 금지, Docker 보안, XSS/CSRF 방어가 포함됨
  </done>
</task>

</tasks>

<verification>
Phase 64 전체 검증:

1. **파일 존재**: `docs/67-admin-web-ui-spec.md` 존재 확인
2. **섹션 완전성**: 섹션 1~7 모두 존재 (grep "^## [1-7]\.")
3. **INFRA-01 충족**: Hono serveStatic 설정, SPA fallback, CSP 헤더, 캐시 정책이 섹션 3에 명시
4. **INFRA-02 충족**: packages/admin 디렉토리 레이아웃, Vite 빌드 설정, 빌드 산출물 복사 전략이 섹션 4에 명시
5. **INFRA-03 충족**: admin_ui, admin_timeout 키 + 환경변수 오버라이드가 섹션 5에 명시
6. **INFRA-04 충족**: admin_ui=false 시 404 동작이 섹션 3에 명시
7. **AUTH-01 충족**: masterAuth 로그인, X-Master-Password, Auth Store signal이 섹션 6에 명시
8. **AUTH-02 충족**: 비활성 타임아웃 15분, logout, 401 리다이렉트가 섹션 6에 명시
9. **SEC-01 충족**: CSP, 메모리 전용 보관, 민감 데이터 금지, Docker 보안이 섹션 7에 명시
</verification>

<success_criteria>
- docs/67-admin-web-ui-spec.md 파일이 존재하고 섹션 1~7 완전
- 7개 요구사항(INFRA-01~04, AUTH-01~02, SEC-01) 모두 설계 문서에 반영
- Phase 65 페이지 설계 착수에 필요한 인프라/인증/보안 기반이 문서에 확정
- 기존 코드베이스(server.ts, loader.ts, master-auth.ts)와 정합하는 설계
</success_criteria>

<output>
After completion, create `.planning/phases/64-infra-auth-security-design/64-01-SUMMARY.md`
</output>
