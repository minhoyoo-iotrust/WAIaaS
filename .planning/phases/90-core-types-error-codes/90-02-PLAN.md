---
phase: 90-core-types-error-codes
plan: 02
type: execute
wave: 2
depends_on: ["90-01"]
files_modified:
  - packages/core/src/i18n/en.ts
  - packages/core/src/i18n/ko.ts
  - packages/core/src/__tests__/enums.test.ts
  - packages/core/src/__tests__/errors.test.ts
  - packages/core/src/__tests__/schemas.test.ts
  - packages/core/src/__tests__/i18n.test.ts
  - packages/core/src/__tests__/package-exports.test.ts
autonomous: true

must_haves:
  truths:
    - "i18n en/ko templates use {walletId} and {walletCount} variables (no {agentId}/{agentCount})"
    - "i18n WALLET_SUSPENDED key exists in en/ko (no AGENT_SUSPENDED key)"
    - "Notification body text says 'Wallet' in en and '지갑' in ko (not 'Agent'/'에이전트')"
    - "All core tests pass with wallet terminology"
    - "Error code count remains at 68 across all test assertions"
  artifacts:
    - path: "packages/core/src/i18n/en.ts"
      provides: "English messages with wallet terminology"
      contains: "WALLET_NOT_FOUND"
    - path: "packages/core/src/i18n/ko.ts"
      provides: "Korean messages with wallet terminology"
      contains: "WALLET_NOT_FOUND"
    - path: "packages/core/src/__tests__/enums.test.ts"
      provides: "Enum tests with WALLET_STATUSES"
      contains: "WALLET_STATUSES"
    - path: "packages/core/src/__tests__/schemas.test.ts"
      provides: "Schema tests with WalletSchema"
      contains: "WalletSchema"
  key_links:
    - from: "packages/core/src/i18n/en.ts"
      to: "packages/core/src/errors/error-codes.ts"
      via: "error key parity (68 keys must match)"
      pattern: "WALLET_NOT_FOUND.*Wallet not found"
    - from: "packages/core/src/__tests__/errors.test.ts"
      to: "packages/core/src/errors/error-codes.ts"
      via: "domain coverage assertion"
      pattern: "WALLET"
---

<objective>
Update i18n templates (en/ko) to use wallet terminology and update all core tests to reference the renamed schemas/enums/error-codes from Plan 90-01.

Purpose: Completes Phase 90 by ensuring all i18n strings and test assertions reflect wallet terminology, with full core test suite passing.
Output: Updated i18n templates with wallet variables/text, updated test files, all core tests green.
</objective>

<execution_context>
@/Users/minho.yoo/.claude/get-shit-done/workflows/execute-plan.md
@/Users/minho.yoo/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/90-core-types-error-codes/90-01-SUMMARY.md
@packages/core/src/i18n/en.ts
@packages/core/src/i18n/ko.ts
@packages/core/src/__tests__/enums.test.ts
@packages/core/src/__tests__/errors.test.ts
@packages/core/src/__tests__/schemas.test.ts
@packages/core/src/__tests__/i18n.test.ts
@packages/core/src/__tests__/package-exports.test.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update i18n en/ko templates for wallet terminology</name>
  <files>
    packages/core/src/i18n/en.ts
    packages/core/src/i18n/ko.ts
  </files>
  <action>
    **en.ts changes:**

    1. **Error message keys** (3 renames): Change the AGENT domain error keys to WALLET domain:
       - `AGENT_NOT_FOUND: 'Agent not found'` -> `WALLET_NOT_FOUND: 'Wallet not found'`
       - `AGENT_SUSPENDED: 'Agent is suspended'` -> `WALLET_SUSPENDED: 'Wallet is suspended'`
       - `AGENT_TERMINATED: 'Agent has been terminated'` -> `WALLET_TERMINATED: 'Wallet has been terminated'`
       - Update the section comment from `// AGENT domain (3)` to `// WALLET domain (3)`

    2. **Error message text** (1 change):
       - `NO_OWNER: 'No owner registered for this agent'` -> `NO_OWNER: 'No owner registered for this wallet'`

    3. **Notification template variables** (~13 changes): In `notifications` object:
       - All `{agentId}` -> `{walletId}` in body strings (~10 occurrences)
       - `{agentCount}` -> `{walletCount}` in DAILY_SUMMARY body
       - Replace "Agent" with "Wallet" in notification body/title text:
         - TX_REQUESTED body: `'Agent {agentId} requested...'` -> `'Wallet {walletId} requested...'`
         - POLICY_VIOLATION body: `'Agent {agentId} policy violation...'` -> `'Wallet {walletId} policy violation...'`
         - AGENT_SUSPENDED key rename to WALLET_SUSPENDED: title `'Agent Suspended'` -> `'Wallet Suspended'`, body `'Agent {agentId} has been suspended...'` -> `'Wallet {walletId} has been suspended...'`
         - SESSION_EXPIRING_SOON body: `'Session {sessionId} for agent {agentId}...'` -> `'Session {sessionId} for wallet {walletId}...'`
         - SESSION_EXPIRED body: `'Session {sessionId} for agent {agentId}...'` -> `'Session {sessionId} for wallet {walletId}...'`
         - SESSION_CREATED body: `'New session created for agent {agentId}'` -> `'New session created for wallet {walletId}'`
         - OWNER_SET body: `'Owner registered for agent {agentId}...'` -> `'Owner registered for wallet {walletId}...'`
         - OWNER_REMOVED body: `'Owner removed from agent {agentId}'` -> `'Owner removed from wallet {walletId}'`
         - OWNER_VERIFIED body: `'Owner verified for agent {agentId}'` -> `'Owner verified for wallet {walletId}'`
         - DAILY_SUMMARY body: `'Agents: {agentCount}...'` -> `'Wallets: {walletCount}...'`

    **ko.ts changes (matching en.ts):**

    1. **Error message keys** (3 renames):
       - `AGENT_NOT_FOUND: '에이전트를 찾을 수 없습니다'` -> `WALLET_NOT_FOUND: '지갑을 찾을 수 없습니다'`
       - `AGENT_SUSPENDED: '에이전트가 정지 상태입니다'` -> `WALLET_SUSPENDED: '지갑이 정지 상태입니다'`
       - `AGENT_TERMINATED: '에이전트가 종료되었습니다'` -> `WALLET_TERMINATED: '지갑이 종료되었습니다'`
       - Update section comment from `// AGENT domain (3)` to `// WALLET domain (3)`

    2. **Error message text** (1 change):
       - `NO_OWNER: '이 에이전트에 등록된 Owner가 없습니다'` -> `NO_OWNER: '이 지갑에 등록된 Owner가 없습니다'`

    3. **Notification template variables** (~13 changes): Same variable renames as en.ts:
       - All `{agentId}` -> `{walletId}` in body strings
       - `{agentCount}` -> `{walletCount}` in DAILY_SUMMARY
       - Replace "에이전트" with "지갑" in notification body/title text:
         - TX_REQUESTED body: `'에이전트 {agentId}가...'` -> `'지갑 {walletId}가...'`  (note: use '이' particle not '가' -> `'지갑 {walletId}이...'` for Korean grammar; actually "지갑"  ends in consonant, so particle becomes "이" not "가". Check the sentence flow: `'지갑 {walletId}이(가) {to}로 {amount} 전송을 요청했습니다'`. Use the `이` form since walletId typically ends in a character.)
         - POLICY_VIOLATION body: `'에이전트 {agentId}'` -> `'지갑 {walletId}'`
         - AGENT_SUSPENDED -> WALLET_SUSPENDED: title `'에이전트 정지'` -> `'지갑 정지'`, body updated similarly
         - SESSION_EXPIRING_SOON body: `'에이전트 {agentId}의 세션...'` -> `'지갑 {walletId}의 세션...'`
         - SESSION_EXPIRED body: `'에이전트 {agentId}의 세션...'` -> `'지갑 {walletId}의 세션...'`
         - SESSION_CREATED body: `'에이전트 {agentId}의 새 세션...'` -> `'지갑 {walletId}의 새 세션...'`
         - OWNER_SET body: `'에이전트 {agentId}에 Owner가...'` -> `'지갑 {walletId}에 Owner가...'`
         - OWNER_REMOVED body: `'에이전트 {agentId}에서 Owner가...'` -> `'지갑 {walletId}에서 Owner가...'`
         - OWNER_VERIFIED body: `'에이전트 {agentId}의 Owner가...'` -> `'지갑 {walletId}의 Owner가...'`
         - DAILY_SUMMARY body: `'에이전트: {agentCount}개...'` -> `'지갑: {walletCount}개...'`

    **Korean particle note:** `지갑 {walletId}이` is correct when walletId ends in consonant (UUID). For body strings that had `에이전트 {agentId}가`, change to `지갑 {walletId}이` since "지갑" ends in "ㅂ" consonant. However, since the walletId is a UUID and the text is a template, use the combined form `이(가)` or simply use `이` consistently. For natural reading, just use the same particle pattern as the existing templates but with "지갑".

    The total error code count stays at 68 keys in both en.ts and ko.ts.
  </action>
  <verify>
    - `grep '{agentId}\|{agentCount}' packages/core/src/i18n/en.ts` returns 0 matches
    - `grep '{agentId}\|{agentCount}' packages/core/src/i18n/ko.ts` returns 0 matches
    - `grep 'AGENT_NOT_FOUND\|AGENT_SUSPENDED\|AGENT_TERMINATED' packages/core/src/i18n/en.ts` returns 0 matches
    - `grep 'WALLET_NOT_FOUND' packages/core/src/i18n/en.ts` returns a match
    - `grep 'WALLET_SUSPENDED' packages/core/src/i18n/en.ts` returns matches (error + notification key)
    - `grep -c 'walletId' packages/core/src/i18n/en.ts` returns 10+
    - `grep -c 'walletCount' packages/core/src/i18n/en.ts` returns 1
  </verify>
  <done>
    - en.ts and ko.ts error keys use WALLET_NOT_FOUND/SUSPENDED/TERMINATED
    - All notification templates use {walletId} and {walletCount}
    - Notification text says "Wallet"/"지갑" instead of "Agent"/"에이전트"
    - Total 68 error keys maintained in both locales
  </done>
</task>

<task type="auto">
  <name>Task 2: Update all core test files + run tests</name>
  <files>
    packages/core/src/__tests__/enums.test.ts
    packages/core/src/__tests__/errors.test.ts
    packages/core/src/__tests__/schemas.test.ts
    packages/core/src/__tests__/i18n.test.ts
    packages/core/src/__tests__/package-exports.test.ts
  </files>
  <action>
    **enums.test.ts changes:**
    - Update imports: `AGENT_STATUSES, AgentStatusEnum` -> `WALLET_STATUSES, WalletStatusEnum`
    - Rename test: `'AgentStatus has 5 values'` -> `'WalletStatus has 5 values'`
    - Change assertion: `expect(AGENT_STATUSES).toHaveLength(5)` -> `expect(WALLET_STATUSES).toHaveLength(5)`
    - Change value assertions: `expect(AGENT_STATUSES).toContain(...)` -> `expect(WALLET_STATUSES).toContain(...)`
    - In "Zod enum options match" test: `expect(AgentStatusEnum.options).toEqual([...AGENT_STATUSES])` -> `expect(WalletStatusEnum.options).toEqual([...WALLET_STATUSES])`
    - In "no duplicate values" test: `AGENT_STATUSES` -> `WALLET_STATUSES` in allArrays

    **errors.test.ts changes:**
    - In domain coverage test: `expect(domains).toContain('AGENT')` -> `expect(domains).toContain('WALLET')`
    - In WAIaaSError tests:
      - `new WAIaaSError('AGENT_NOT_FOUND')` -> `new WAIaaSError('WALLET_NOT_FOUND')`
      - `expect(err.code).toBe('AGENT_NOT_FOUND')` -> `expect(err.code).toBe('WALLET_NOT_FOUND')`
      - Default message test: `expect(err.message).toBe('Agent not found')` -> `expect(err.message).toBe('Wallet not found')`

    **schemas.test.ts changes:**
    - Update imports: `AgentSchema, CreateAgentRequestSchema` -> `WalletSchema, CreateWalletRequestSchema`
    - Rename all describe/it blocks: `'CreateAgentRequestSchema'` -> `'CreateWalletRequestSchema'`, `'AgentSchema'` -> `'WalletSchema'`
    - Change all `CreateAgentRequestSchema.parse(...)` -> `CreateWalletRequestSchema.parse(...)`
    - Change all `AgentSchema.parse(...)` -> `WalletSchema.parse(...)`
    - In SessionSchema test: `agentId:` field stays as `agentId:` if the value is just test data, BUT since we renamed the schema field to walletId in Plan 90-01 Task 1, change:
      - SessionSchema test fixture: `agentId: '...'` -> `walletId: '...'`
    - In TransactionSchema test fixture: `agentId: '...'` -> `walletId: '...'`
    - In PolicySchema test fixture: `agentId: '...'` -> `walletId: '...'`

    **i18n.test.ts changes:**
    - `expect(msg.errors.AGENT_NOT_FOUND).toBe('Agent not found')` -> `expect(msg.errors.WALLET_NOT_FOUND).toBe('Wallet not found')`
    - `expect(msg.errors.AGENT_NOT_FOUND).toBe('에이전트를 찾을 수 없습니다')` -> `expect(msg.errors.WALLET_NOT_FOUND).toBe('지갑을 찾을 수 없습니다')`
    - Default locale test: `expect(msg.errors.AGENT_NOT_FOUND).toBe('Agent not found')` -> `expect(msg.errors.WALLET_NOT_FOUND).toBe('Wallet not found')`

    **package-exports.test.ts changes:**
    - `expect(core.AGENT_STATUSES).toBeDefined()` -> `expect(core.WALLET_STATUSES).toBeDefined()`
    - `expect(core.AgentStatusEnum).toBeDefined()` -> `expect(core.WalletStatusEnum).toBeDefined()`
    - `expect(core.AgentSchema).toBeDefined()` -> `expect(core.WalletSchema).toBeDefined()`
    - `expect(core.CreateAgentRequestSchema).toBeDefined()` -> `expect(core.CreateWalletRequestSchema).toBeDefined()`

    **Run tests:**
    After all changes, run `cd packages/core && npx vitest run` to verify all core tests pass.
  </action>
  <verify>
    - `cd packages/core && npx vitest run` passes all tests (0 failures)
    - `grep 'AGENT_STATUSES\|AgentStatusEnum\|AgentSchema\|CreateAgentRequest\|AGENT_NOT_FOUND\|AGENT_SUSPENDED\|AGENT_TERMINATED' packages/core/src/__tests__/*.ts` returns 0 matches
    - `grep 'agentId' packages/core/src/__tests__/schemas.test.ts` returns 0 matches (all changed to walletId)
  </verify>
  <done>
    - All 5 test files updated with wallet terminology
    - All core tests pass (enums, errors, schemas, i18n, package-exports)
    - Zero references to old Agent-prefixed names in test files
  </done>
</task>

</tasks>

<verification>
1. `grep -r '{agentId}\|{agentCount}' packages/core/src/i18n/` returns 0 matches
2. `grep -r 'AGENT_NOT_FOUND\|AGENT_SUSPENDED\|AGENT_TERMINATED\|AGENT_STATUSES\|AgentSchema\|AgentStatusEnum' packages/core/src/` returns 0 matches (entire src/)
3. `cd packages/core && npx vitest run` all tests pass
4. `cd packages/core && npx tsc --noEmit` compiles successfully
5. `grep -r 'agentId' packages/core/src/schemas/` returns 0 (all walletId)
6. `grep -r 'agentId' packages/core/src/__tests__/schemas.test.ts` returns 0 (all walletId)
</verification>

<success_criteria>
- i18n en/ko use {walletId}/{walletCount} with 0 {agentId}/{agentCount} remaining
- WALLET_SUSPENDED notification key exists, AGENT_SUSPENDED key is 0
- Notification text says "Wallet"/"지갑" everywhere
- All 5 test files updated, all core tests pass
- `tsc --noEmit` passes for core package
- Complete Phase 90 success criteria met: zero agent terminology in @waiaas/core
</success_criteria>

<output>
After completion, create `.planning/phases/90-core-types-error-codes/90-02-SUMMARY.md`
</output>
