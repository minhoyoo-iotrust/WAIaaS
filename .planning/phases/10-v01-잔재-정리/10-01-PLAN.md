---
phase: 10-v01-잔재-정리
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .planning/deliverables/41-v01-v02-mapping.md
  - .planning/deliverables/03-database-caching-strategy.md
  - .planning/deliverables/09-system-components.md
  - .planning/deliverables/10-transaction-flow.md
  - .planning/deliverables/18-authentication-model.md
  - .planning/deliverables/19-permission-policy-model.md
  - .planning/deliverables/15-agent-lifecycle-management.md
autonomous: true

must_haves:
  truths:
    - "v0.1 -> v0.2 변경 매핑 문서가 40개 문서 간 대체/계승 관계를 명시함"
    - "v0.2에서 대체된 v0.1 문서 상단에 SUPERSEDED 경고 박스가 존재함"
    - "구현자가 어떤 문서를 참조해야 하는지 명확히 구분 가능함"
  artifacts:
    - path: ".planning/deliverables/41-v01-v02-mapping.md"
      provides: "v0.1 -> v0.2 변경 매핑 문서"
      contains: "SUPERSEDED 대상"
    - path: ".planning/deliverables/03-database-caching-strategy.md"
      provides: "C4 SUPERSEDED 표기"
      contains: "SUPERSEDED"
    - path: ".planning/deliverables/18-authentication-model.md"
      provides: "C6 SUPERSEDED 표기"
      contains: "SUPERSEDED"
  key_links:
    - from: ".planning/deliverables/03-database-caching-strategy.md"
      to: ".planning/deliverables/25-sqlite-schema.md"
      via: "SUPERSEDED 링크"
      pattern: "25-sqlite-schema\\.md"
    - from: ".planning/deliverables/41-v01-v02-mapping.md"
      to: "v0.2 deliverables"
      via: "대체 문서 참조"
      pattern: "2[4-9]|3[0-9]|40"
---

<objective>
v0.1 -> v0.2 변경 매핑 문서를 작성하고, v0.2에서 대체된 v0.1 문서에 SUPERSEDED 표기를 추가한다.

Purpose: 구현 단계에서 v0.1의 구식 설계를 참조하는 실수를 방지하고, 40개 설계 문서 간 대체/계승 관계를 명확히 한다.
Output: 41-v01-v02-mapping.md (변경 매핑 문서) + 6개 v0.1 문서에 SUPERSEDED 표기 추가
</objective>

<execution_context>
@/Users/minho.yoo/.claude/get-shit-done/workflows/execute-plan.md
@/Users/minho.yoo/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/REQUIREMENTS.md
@.planning/phases/10-v01-잔재-정리/10-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: v0.1 -> v0.2 변경 매핑 문서 작성</name>
  <files>.planning/deliverables/41-v01-v02-mapping.md</files>
  <action>
  RESEARCH.md의 "문서 대체 관계 분석" 섹션을 기반으로 변경 매핑 문서 작성:

  1. 프론트매터: 작성일, 버전, 문서 ID (MAP-01)

  2. 개요 섹션:
     - v0.1 (23개) + v0.2 (17개) = 40개 설계 문서
     - v0.1 -> v0.2 주요 아키텍처 전환 요약 (Cloud -> Self-Hosted)

  3. 문서 분류 테이블 3개:

     **SUPERSEDED 대상 (완전 대체):**
     | v0.1 문서 | 문서 ID | v0.2 대체 문서 | 관련 이슈 | 변경 요약 |
     - 03-database-caching-strategy.md | TECH-03 | 25-sqlite-schema.md | C4 | PostgreSQL+Redis -> SQLite+LRU
     - 09-system-components.md (일부) | ARCH-02 | 29-api-framework-design.md | C5 | Fastify -> Hono
     - 10-transaction-flow.md (일부) | ARCH-03 | 32-transaction-pipeline-api.md | C5, H13 | 8단계 -> 6단계
     - 18-authentication-model.md | API-02 | 30-session-token-protocol.md | C6 | API Key -> JWT 세션
     - 19-permission-policy-model.md | API-03 | 33-time-lock-approval-mechanism.md | C6, H13 | RBAC -> 4-tier
     - 15-agent-lifecycle-management.md (일부) | REL-03 | 26-keystore-spec.md | C7 | AWS KMS -> 로컬 Keystore

     **PARTIALLY VALID (일부 유효):**
     | v0.1 문서 | 유효 부분 | 대체된 부분 | v0.2 대체 문서 |
     - 01-tech-stack-decision.md (TECH-01) | 언어/프레임워크 비교 | PostgreSQL, Fastify 선택 | 24-monorepo, 29-api-framework
     - 08-dual-key-architecture.md | Dual Key 개념 | Squads 2-of-2 | 33-time-lock-approval
     - 11-security-threat-model.md | 위협 분류 | Enclave/KMS 대응 | 26-keystore, 36-killswitch
     - 12-multichain-extension.md (일부) | 멀티체인 개념 | IBlockchainAdapter, Squads | 27-chain-adapter-interface
     - 13-fund-deposit-process.md | 충전 개념 | Squads Vault | Phase 11 확정 예정 (C8)
     - 14-fund-withdrawal-process.md | 회수 개념 | Owner Key 서명 | 34-owner-wallet-connection
     - 20-error-codes.md (API-04) | 에러 구조 개념 | RFC 9457 46개 코드 | 37-rest-api-complete-spec (36개)

     **VALID (여전히 유효):**
     | v0.1 문서 | 이유 |
     - 02-solana-environment.md | Solana 개발 환경 동일
     - 04-custody-model-comparison.md | 리서치 가치 유지
     - 05-provider-comparison.md | 외부 프로바이더 비교
     - 06-ai-agent-custody-considerations.md | AI 에이전트 고려사항
     - 07-recommended-custody-model.md | Self-Custody 선택 근거
     - 16-emergency-recovery.md | 복구 개념 (Kill Switch와 연계)
     - 17-multi-agent-management.md | 멀티 에이전트 개념
     - 21-openapi-spec.md | v0.2 37-rest-api로 확장됨
     - 22-sdk-interface.md | v0.2 38-sdk-mcp로 확장됨
     - 23-mcp-integration.md | v0.2 38-sdk-mcp로 확장됨

  4. State of the Art 요약 (RESEARCH.md에서 가져옴)

  5. 구현 가이드라인:
     - v0.2 문서 우선 참조
     - SUPERSEDED 문서는 리서치 목적으로만 참조
     - PARTIALLY VALID 문서는 유효 부분만 참조
  </action>
  <verify>
  ```bash
  # 문서 존재 확인
  test -f .planning/deliverables/41-v01-v02-mapping.md && echo "PASS: 매핑 문서 생성됨"

  # 3개 분류 테이블 존재 확인
  grep -c "SUPERSEDED 대상\|PARTIALLY VALID\|VALID" .planning/deliverables/41-v01-v02-mapping.md
  # 예상: 3 (3개 섹션 헤더)

  # v0.1 23개 문서가 모두 매핑되었는지 확인
  grep -E "^\\| [0-9]{2}-" .planning/deliverables/41-v01-v02-mapping.md | wc -l
  # 예상: 23 이상 (SUPERSEDED + PARTIALLY + VALID 합계)
  ```
  </verify>
  <done>
  - 41-v01-v02-mapping.md 파일이 존재함
  - SUPERSEDED/PARTIALLY VALID/VALID 3개 분류로 23개 v0.1 문서가 정리됨
  - 각 SUPERSEDED 문서에 대체 v0.2 문서가 명시됨
  </done>
</task>

<task type="auto">
  <name>Task 2: v0.1 문서에 SUPERSEDED 표기 추가</name>
  <files>
    .planning/deliverables/03-database-caching-strategy.md
    .planning/deliverables/09-system-components.md
    .planning/deliverables/10-transaction-flow.md
    .planning/deliverables/18-authentication-model.md
    .planning/deliverables/19-permission-policy-model.md
    .planning/deliverables/15-agent-lifecycle-management.md
  </files>
  <action>
  각 v0.1 문서의 프론트매터 바로 아래(제목 다음)에 SUPERSEDED 표기를 추가한다.
  ADR 표준 + Visual Warning Callout 패턴 조합 사용.

  **03-database-caching-strategy.md (TECH-03):**
  제목 바로 아래에 추가:
  ```markdown
  **상태:** SUPERSEDED by [25-sqlite-schema.md](./25-sqlite-schema.md)

  ---

  > **SUPERSEDED**
  >
  > 이 문서의 데이터베이스 설계(PostgreSQL + Redis)는 v0.2에서 **SQLite + LRU 캐시**로 대체되었습니다.
  >
  > **구현 시 참조:** [25-sqlite-schema.md](./25-sqlite-schema.md) (CORE-02)
  >
  > **변경 이유:** Self-Hosted 단일 프로세스 환경에서 외부 DB 의존성 제거

  ---
  ```

  **09-system-components.md (ARCH-02):**
  ```markdown
  **상태:** PARTIALLY SUPERSEDED by [29-api-framework-design.md](./29-api-framework-design.md)

  ---

  > **PARTIALLY SUPERSEDED**
  >
  > 이 문서의 API 프레임워크 설계(Fastify)는 v0.2에서 **Hono**로 대체되었습니다.
  > 시스템 컴포넌트 구조 개념은 여전히 유효합니다.
  >
  > **구현 시 참조:** [29-api-framework-design.md](./29-api-framework-design.md) (CORE-06)

  ---
  ```

  **10-transaction-flow.md (ARCH-03):**
  ```markdown
  **상태:** PARTIALLY SUPERSEDED by [32-transaction-pipeline-api.md](./32-transaction-pipeline-api.md)

  ---

  > **PARTIALLY SUPERSEDED**
  >
  > 이 문서의 8단계 트랜잭션 플로우는 v0.2에서 **6단계 파이프라인**으로 대체되었습니다.
  > Enclave 서명, Squads 승인 단계가 제거되고 로컬 정책 엔진으로 대체되었습니다.
  >
  > **구현 시 참조:** [32-transaction-pipeline-api.md](./32-transaction-pipeline-api.md) (TX-PIPE)

  ---
  ```

  **18-authentication-model.md (API-02):**
  ```markdown
  **상태:** SUPERSEDED by [30-session-token-protocol.md](./30-session-token-protocol.md)

  ---

  > **SUPERSEDED**
  >
  > 이 문서의 인증 모델(영구 API Key + RBAC/ABAC)은 v0.2에서 **JWT 세션 토큰 + SIWS/SIWE**로 대체되었습니다.
  >
  > **구현 시 참조:** [30-session-token-protocol.md](./30-session-token-protocol.md) (SESS-PROTO)
  >
  > **변경 이유:** 토큰 탈취 위험 감소, Self-Hosted 환경에 적합한 단기 세션

  ---
  ```

  **19-permission-policy-model.md (API-03):**
  ```markdown
  **상태:** SUPERSEDED by [33-time-lock-approval-mechanism.md](./33-time-lock-approval-mechanism.md)

  ---

  > **SUPERSEDED**
  >
  > 이 문서의 권한/정책 모델(RBAC/ABAC + 4단계 에스컬레이션)은 v0.2에서 **4-tier 금액 기반 정책**으로 대체되었습니다.
  >
  > **구현 시 참조:** [33-time-lock-approval-mechanism.md](./33-time-lock-approval-mechanism.md) (LOCK-MECH)
  >
  > **변경 내용:** Level 1-4 에스컬레이션 -> INSTANT/NOTIFY/DELAY/APPROVAL 4-tier

  ---
  ```

  **15-agent-lifecycle-management.md (REL-03):**
  ```markdown
  **상태:** PARTIALLY SUPERSEDED by [26-keystore-spec.md](./26-keystore-spec.md)

  ---

  > **PARTIALLY SUPERSEDED**
  >
  > 이 문서의 키 관리 부분(AWS KMS + Nitro Enclaves)은 v0.2에서 **로컬 Keystore + sodium-native**로 대체되었습니다.
  > 에이전트 생명주기 개념(생성, 활성화, 비활성화, 종료)은 여전히 유효합니다.
  >
  > **구현 시 참조:** [26-keystore-spec.md](./26-keystore-spec.md) (CORE-03)

  ---
  ```

  **중요:** 기존 문서 내용은 그대로 유지하고 상단에만 표기를 추가한다.
  </action>
  <verify>
  ```bash
  # 6개 문서에 SUPERSEDED 표기가 추가되었는지 확인
  for doc in 03-database-caching-strategy 09-system-components 10-transaction-flow 18-authentication-model 19-permission-policy-model 15-agent-lifecycle-management; do
    if grep -q "SUPERSEDED" .planning/deliverables/${doc}.md; then
      echo "PASS: ${doc}.md"
    else
      echo "FAIL: ${doc}.md"
    fi
  done

  # 대체 문서 링크가 올바른지 확인
  grep -l "25-sqlite-schema.md\|29-api-framework-design.md\|30-session-token-protocol.md\|32-transaction-pipeline-api.md\|33-time-lock-approval-mechanism.md\|26-keystore-spec.md" .planning/deliverables/*.md | wc -l
  # 예상: 6 이상
  ```
  </verify>
  <done>
  - 6개 v0.1 문서에 SUPERSEDED/PARTIALLY SUPERSEDED 표기가 추가됨
  - 각 표기에 대체 v0.2 문서 링크가 포함됨
  - 기존 문서 내용은 그대로 유지됨
  </done>
</task>

</tasks>

<verification>
Phase 10 Plan 01 완료 검증:

1. **LEGACY-01 충족**: 41-v01-v02-mapping.md가 40개 문서 간 대체/계승 관계를 명시함
2. **LEGACY-02 충족**: 03-database-caching-strategy.md에 SUPERSEDED 표기 (PostgreSQL+Redis -> SQLite+LRU)
3. **LEGACY-03 충족**: 09-system-components.md에 PARTIALLY SUPERSEDED 표기 (Fastify -> Hono)
4. **LEGACY-04 충족**: 18-authentication-model.md, 19-permission-policy-model.md에 SUPERSEDED 표기
5. **LEGACY-05 충족**: 15-agent-lifecycle-management.md에 PARTIALLY SUPERSEDED 표기 (AWS KMS -> 로컬 Keystore)

```bash
# 전체 검증
test -f .planning/deliverables/41-v01-v02-mapping.md && \
grep -q "SUPERSEDED" .planning/deliverables/03-database-caching-strategy.md && \
grep -q "SUPERSEDED" .planning/deliverables/18-authentication-model.md && \
echo "Phase 10 Plan 01 VERIFIED"
```
</verification>

<success_criteria>
- [ ] 41-v01-v02-mapping.md 파일이 .planning/deliverables/에 존재함
- [ ] 매핑 문서가 SUPERSEDED/PARTIALLY VALID/VALID 3개 분류를 포함함
- [ ] 23개 v0.1 문서가 모두 분류됨
- [ ] 6개 v0.1 문서에 SUPERSEDED 표기가 상단에 추가됨
- [ ] 모든 SUPERSEDED 표기에 v0.2 대체 문서 링크가 포함됨
- [ ] 기존 v0.1 문서 내용이 유지됨 (삭제되지 않음)
</success_criteria>

<output>
After completion, create `.planning/phases/10-v01-잔재-정리/10-01-SUMMARY.md`
</output>
