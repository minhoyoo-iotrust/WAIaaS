---
phase: 67-auth-api-client-components
plan: 02
type: execute
wave: 2
depends_on: ["67-01"]
files_modified:
  - packages/admin/src/components/layout.tsx
  - packages/admin/src/components/table.tsx
  - packages/admin/src/components/form.tsx
  - packages/admin/src/components/modal.tsx
  - packages/admin/src/components/toast.tsx
  - packages/admin/src/components/copy-button.tsx
  - packages/admin/src/components/empty-state.tsx
  - packages/admin/src/utils/error-messages.ts
  - packages/admin/src/utils/format.ts
  - packages/admin/src/pages/dashboard.tsx
  - packages/admin/src/pages/agents.tsx
  - packages/admin/src/pages/sessions.tsx
  - packages/admin/src/pages/policies.tsx
  - packages/admin/src/pages/settings.tsx
  - packages/admin/src/app.tsx
autonomous: true

must_haves:
  truths:
    - "Sidebar navigation renders 5 links (Dashboard, Agents, Sessions, Policies, Settings) with active state highlighting"
    - "Hash routing switches between 5 page placeholders via sidebar navigation"
    - "Each page shows a header with page title and Logout button"
    - "Table component renders columns with data, supports loading/empty states"
    - "Modal component renders overlay with confirm/cancel actions"
    - "Toast notifications appear top-right and auto-dismiss after 5 seconds"
    - "CopyButton copies text to clipboard with visual feedback"
    - "68 error codes map to user-friendly English messages"
    - "formatDate, formatAddress, formatUptime utilities produce correct output"
  artifacts:
    - path: "packages/admin/src/components/layout.tsx"
      provides: "Sidebar + Header + Content layout with hash router"
      exports: ["Layout"]
    - path: "packages/admin/src/components/table.tsx"
      provides: "Generic table with column definitions, loading, empty state"
      exports: ["Table"]
    - path: "packages/admin/src/components/form.tsx"
      provides: "FormField, Button, Badge reusable components"
      exports: ["FormField", "Button", "Badge"]
    - path: "packages/admin/src/components/modal.tsx"
      provides: "Confirm/cancel modal dialog"
      exports: ["Modal"]
    - path: "packages/admin/src/components/toast.tsx"
      provides: "Toast notification system with signal-based state"
      exports: ["ToastContainer", "showToast"]
    - path: "packages/admin/src/components/copy-button.tsx"
      provides: "Clipboard copy button with fallback"
      exports: ["CopyButton"]
    - path: "packages/admin/src/components/empty-state.tsx"
      provides: "Empty state placeholder with optional action"
      exports: ["EmptyState"]
    - path: "packages/admin/src/utils/error-messages.ts"
      provides: "68 error code to user-friendly message mapping"
      exports: ["getErrorMessage"]
    - path: "packages/admin/src/utils/format.ts"
      provides: "formatUptime, formatDate, formatAddress utilities"
      exports: ["formatUptime", "formatDate", "formatAddress"]
    - path: "packages/admin/src/app.tsx"
      provides: "Updated root with Layout + Router integration"
      exports: ["App"]
  key_links:
    - from: "packages/admin/src/app.tsx"
      to: "packages/admin/src/components/layout.tsx"
      via: "Renders Layout when authenticated"
      pattern: "<Layout"
    - from: "packages/admin/src/components/layout.tsx"
      to: "packages/admin/src/pages/*.tsx"
      via: "preact-router hash routing to page components"
      pattern: "Router|path="
    - from: "packages/admin/src/components/layout.tsx"
      to: "packages/admin/src/auth/store.ts"
      via: "Logout button calls logout()"
      pattern: "logout\\(\\)"
---

<objective>
Implement the Layout shell (sidebar + header + router), 7 reusable UI components (Table, FormField, Button, Badge, Modal, Toast, CopyButton, EmptyState), 5 page placeholders, error message mapping, and formatting utilities.

Purpose: All pages in Phase 68-69 depend on the shared layout, component library, and utility functions. Building them first eliminates duplication and ensures consistent UI patterns.

Output: Full application shell with working navigation, component library ready for page implementation, and utility functions for error display and data formatting.
</objective>

<execution_context>
@/Users/minho.yoo/.claude/get-shit-done/workflows/execute-plan.md
@/Users/minho.yoo/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/67-auth-api-client-components/67-01-SUMMARY.md

# Auth store and API client from Plan 01
@packages/admin/src/auth/store.ts
@packages/admin/src/api/client.ts
@packages/admin/src/api/endpoints.ts
@packages/admin/src/styles/global.css
@packages/admin/src/app.tsx

# Error codes for mapping
@packages/core/src/errors/error-codes.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Layout + Page Placeholders + Utils + Update App</name>
  <files>
    packages/admin/src/components/layout.tsx
    packages/admin/src/pages/dashboard.tsx
    packages/admin/src/pages/agents.tsx
    packages/admin/src/pages/sessions.tsx
    packages/admin/src/pages/policies.tsx
    packages/admin/src/pages/settings.tsx
    packages/admin/src/utils/error-messages.ts
    packages/admin/src/utils/format.ts
    packages/admin/src/app.tsx
  </files>
  <action>
**1. Create `packages/admin/src/utils/format.ts`:**

Three utility functions:

```typescript
/** Format seconds as human-readable uptime: "2d 5h 30m" or "5h 30m" or "30m" */
export function formatUptime(seconds: number): string {
  const d = Math.floor(seconds / 86400);
  const h = Math.floor((seconds % 86400) / 3600);
  const m = Math.floor((seconds % 3600) / 60);
  if (d > 0) return `${d}d ${h}h ${m}m`;
  if (h > 0) return `${h}h ${m}m`;
  return `${m}m`;
}

/** Format Unix timestamp (seconds) as "YYYY-MM-DD HH:mm" in local timezone */
export function formatDate(timestamp: number): string {
  const d = new Date(timestamp * 1000);
  const pad = (n: number) => n.toString().padStart(2, '0');
  return `${d.getFullYear()}-${pad(d.getMonth() + 1)}-${pad(d.getDate())} ${pad(d.getHours())}:${pad(d.getMinutes())}`;
}

/** Truncate blockchain address: first 4 + ".." + last 4 */
export function formatAddress(address: string): string {
  if (address.length <= 10) return address;
  return `${address.slice(0, 4)}..${address.slice(-4)}`;
}
```

**2. Create `packages/admin/src/utils/error-messages.ts`:**

Map all 68 error codes from `@waiaas/core/src/errors/error-codes.ts` to user-friendly English messages. Do NOT import from core (admin is a frontend package with no workspace deps). Duplicate the mapping as a standalone record:

```typescript
const ERROR_MESSAGES: Record<string, string> = {
  // AUTH domain
  INVALID_TOKEN: 'Your authentication token is invalid. Please log in again.',
  TOKEN_EXPIRED: 'Your session token has expired. Please log in again.',
  SESSION_REVOKED: 'Your session has been revoked by an administrator.',
  INVALID_SIGNATURE: 'The cryptographic signature is invalid.',
  INVALID_NONCE: 'The authentication nonce is invalid or has expired.',
  INVALID_MASTER_PASSWORD: 'Invalid master password. Please try again.',
  MASTER_PASSWORD_LOCKED: 'Master password is locked due to too many failed attempts. Please wait.',
  SYSTEM_LOCKED: 'The system is currently locked.',

  // SESSION domain
  SESSION_NOT_FOUND: 'Session not found.',
  SESSION_EXPIRED: 'The session has expired.',
  SESSION_LIMIT_EXCEEDED: 'Maximum number of sessions reached.',
  CONSTRAINT_VIOLATED: 'A session constraint was violated.',
  RENEWAL_LIMIT_REACHED: 'Session renewal limit has been reached. Create a new session.',
  SESSION_ABSOLUTE_LIFETIME_EXCEEDED: 'Session has exceeded its maximum lifetime.',
  RENEWAL_TOO_EARLY: 'Session renewal attempted too early. Please wait.',
  SESSION_RENEWAL_MISMATCH: 'Session renewal count mismatch. The session may have been renewed elsewhere.',

  // TX domain
  PIPELINE_HALTED: 'Transaction is queued for delay or approval.',
  INSUFFICIENT_BALANCE: 'Insufficient balance for this transaction.',
  INVALID_ADDRESS: 'The blockchain address is invalid.',
  TX_NOT_FOUND: 'Transaction not found.',
  TX_EXPIRED: 'The transaction has expired.',
  TX_ALREADY_PROCESSED: 'This transaction has already been processed.',
  CHAIN_ERROR: 'A blockchain network error occurred. Please try again.',
  SIMULATION_FAILED: 'Transaction simulation failed. The transaction may revert.',
  TOKEN_NOT_FOUND: 'Token not found.',
  TOKEN_NOT_ALLOWED: 'This token is not in the allowed list.',
  INSUFFICIENT_TOKEN_BALANCE: 'Insufficient token balance.',
  CONTRACT_CALL_DISABLED: 'Contract calls are disabled. Configure a CONTRACT_WHITELIST policy first.',
  CONTRACT_NOT_WHITELISTED: 'This contract address is not whitelisted.',
  METHOD_NOT_WHITELISTED: 'This contract method is not whitelisted.',
  APPROVE_DISABLED: 'Token approvals are disabled. Configure an APPROVED_SPENDERS policy first.',
  SPENDER_NOT_APPROVED: 'This spender address is not in the approved list.',
  APPROVE_AMOUNT_EXCEEDED: 'The approve amount exceeds the configured limit.',
  UNLIMITED_APPROVE_BLOCKED: 'Unlimited token approvals are blocked by policy.',
  BATCH_NOT_SUPPORTED: 'Batch transactions are not supported on this chain.',
  BATCH_SIZE_EXCEEDED: 'Batch contains too many instructions (maximum 20).',
  BATCH_POLICY_VIOLATION: 'A policy violation occurred in the batch transaction.',

  // POLICY domain
  POLICY_NOT_FOUND: 'Policy not found.',
  POLICY_DENIED: 'Transaction denied by policy.',
  SPENDING_LIMIT_EXCEEDED: 'Spending limit has been exceeded.',
  RATE_LIMIT_EXCEEDED: 'Rate limit exceeded. Please wait before retrying.',
  WHITELIST_DENIED: 'The destination address is not in the whitelist.',

  // OWNER domain
  OWNER_ALREADY_CONNECTED: 'An owner wallet is already connected to this agent.',
  OWNER_NOT_CONNECTED: 'No owner wallet is connected to this agent.',
  OWNER_NOT_FOUND: 'Owner not found.',
  APPROVAL_TIMEOUT: 'The approval request has timed out.',
  APPROVAL_NOT_FOUND: 'Approval request not found.',

  // SYSTEM domain
  KILL_SWITCH_ACTIVE: 'Kill switch is active. All operations are suspended.',
  KILL_SWITCH_NOT_ACTIVE: 'Kill switch is not currently active.',
  KEYSTORE_LOCKED: 'The keystore is locked. Please try again.',
  CHAIN_NOT_SUPPORTED: 'This blockchain is not supported.',
  SHUTTING_DOWN: 'The daemon is shutting down.',
  ADAPTER_NOT_AVAILABLE: 'Chain adapter is not available. Please try again.',

  // AGENT domain
  AGENT_NOT_FOUND: 'Agent not found.',
  AGENT_SUSPENDED: 'This agent is currently suspended.',
  AGENT_TERMINATED: 'This agent has been terminated.',

  // WITHDRAW domain
  NO_OWNER: 'No owner connected. Withdrawal requires an owner wallet.',
  WITHDRAW_LOCKED_ONLY: 'Withdrawal is only available when the owner state is LOCKED.',
  SWEEP_TOTAL_FAILURE: 'All sweep operations failed. Please try again.',
  INSUFFICIENT_FOR_FEE: 'Insufficient balance to cover transaction fees.',

  // ACTION domain
  ACTION_NOT_FOUND: 'Action not found.',
  ACTION_VALIDATION_FAILED: 'Action input validation failed.',
  ACTION_RESOLVE_FAILED: 'Action failed due to an external API error. Please try again.',
  ACTION_RETURN_INVALID: 'Action returned an invalid result.',
  ACTION_PLUGIN_LOAD_FAILED: 'Failed to load the action plugin.',
  ACTION_NAME_CONFLICT: 'An action with this name already exists.',
  ACTION_CHAIN_MISMATCH: 'The request chain does not match the action provider.',

  // ADMIN domain
  ROTATION_TOO_RECENT: 'Key rotation was attempted too recently. Please wait.',

  // Network/timeout (client-side)
  NETWORK_ERROR: 'Cannot connect to the daemon. Check if it is running.',
  TIMEOUT: 'Request timed out. The daemon may be busy.',
};

/**
 * Get user-friendly error message for an error code.
 * Falls back to the code itself if not mapped.
 */
export function getErrorMessage(code: string): string {
  return ERROR_MESSAGES[code] ?? `An error occurred (${code}).`;
}
```

That's 68 server codes + 2 client-side codes (NETWORK_ERROR, TIMEOUT) = 70 total.

**3. Create 5 page placeholder components:**

Each page is a minimal placeholder that will be fully implemented in Phase 68-69. Each exports a default function component:

`packages/admin/src/pages/dashboard.tsx`:
```tsx
export default function DashboardPage() {
  return <div class="page"><h2>Dashboard</h2><p>Coming in Phase 68...</p></div>;
}
```

`packages/admin/src/pages/agents.tsx`:
```tsx
export default function AgentsPage() {
  return <div class="page"><h2>Agents</h2><p>Coming in Phase 68...</p></div>;
}
```

`packages/admin/src/pages/sessions.tsx`:
```tsx
export default function SessionsPage() {
  return <div class="page"><h2>Sessions</h2><p>Coming in Phase 68...</p></div>;
}
```

`packages/admin/src/pages/policies.tsx`:
```tsx
export default function PoliciesPage() {
  return <div class="page"><h2>Policies</h2><p>Coming in Phase 69...</p></div>;
}
```

`packages/admin/src/pages/settings.tsx`:
```tsx
export default function SettingsPage() {
  return <div class="page"><h2>Settings</h2><p>Coming in Phase 69...</p></div>;
}
```

**4. Create `packages/admin/src/components/layout.tsx`:**

Layout with sidebar + header + content area + hash-based routing.

Import preact-router:
```tsx
import Router from 'preact-router';
import { route } from 'preact-router';
```

NOTE on preact-router 4.1: It does NOT support hash routing natively. Use `createHashHistory` from the `history` package or manually implement hash-based routing. Since we do NOT want to add another dependency (history package), implement a simple custom hash router approach:

**Custom hash routing approach** (no extra dependencies):
- Use `window.location.hash` for navigation
- Listen to `hashchange` event with a signal
- Render the correct page based on hash value

Actually, check if preact-router supports hash history. preact-router 4.1 can work with hash via `Router` component's `url` prop. Alternative approach:

**Simplest approach**: Use `signal` to track current hash path and render pages conditionally. This avoids preact-router complexity entirely and gives us full control:

```tsx
import { signal, computed } from '@preact/signals';
import { useEffect } from 'preact/hooks';
import { logout } from '../auth/store';
import DashboardPage from '../pages/dashboard';
import AgentsPage from '../pages/agents';
import SessionsPage from '../pages/sessions';
import PoliciesPage from '../pages/policies';
import SettingsPage from '../pages/settings';
```

Module-level signal:
```typescript
const currentPath = signal(window.location.hash.slice(1) || '/dashboard');
```

Listen to hashchange:
```typescript
window.addEventListener('hashchange', () => {
  currentPath.value = window.location.hash.slice(1) || '/dashboard';
});
```

Navigation links use: `<a href="#/dashboard">Dashboard</a>` — native hash links, no JS needed for navigation.

Page title derived:
```typescript
const PAGE_TITLES: Record<string, string> = {
  '/dashboard': 'Dashboard',
  '/agents': 'Agents',
  '/sessions': 'Sessions',
  '/policies': 'Policies',
  '/settings': 'Settings',
};
```

Nav items:
```typescript
const NAV_ITEMS = [
  { path: '/dashboard', label: 'Dashboard', icon: '...' },
  { path: '/agents', label: 'Agents', icon: '...' },
  { path: '/sessions', label: 'Sessions', icon: '...' },
  { path: '/policies', label: 'Policies', icon: '...' },
  { path: '/settings', label: 'Settings', icon: '...' },
];
```

For icons, use simple text/emoji or Unicode characters (no icon library to avoid deps). Use text labels only — keep it clean and minimal.

Layout component structure:
```tsx
export function Layout() {
  return (
    <div class="layout">
      <aside class="sidebar">
        <div class="sidebar-brand">WAIaaS</div>
        <nav class="sidebar-nav">
          {NAV_ITEMS.map(item => (
            <a
              href={`#${item.path}`}
              class={`sidebar-link ${currentPath.value === item.path ? 'active' : ''}`}
            >
              {item.label}
            </a>
          ))}
        </nav>
      </aside>
      <main class="main">
        <header class="header">
          <h1 class="header-title">{PAGE_TITLES[currentPath.value] ?? 'Dashboard'}</h1>
          <button class="btn-logout" onClick={() => logout()}>Logout</button>
        </header>
        <div class="content">
          <PageRouter />
        </div>
      </main>
    </div>
  );
}
```

`PageRouter` component:
```tsx
function PageRouter() {
  switch (currentPath.value) {
    case '/agents': return <AgentsPage />;
    case '/sessions': return <SessionsPage />;
    case '/policies': return <PoliciesPage />;
    case '/settings': return <SettingsPage />;
    default: return <DashboardPage />;
  }
}
```

**CSS for layout** — add to `packages/admin/src/styles/global.css` (append):

```css
/* Layout */
.layout {
  display: flex;
  min-height: 100vh;
}

.sidebar {
  width: var(--sidebar-width);
  background: var(--color-bg);
  border-right: 1px solid var(--color-border);
  display: flex;
  flex-direction: column;
  position: fixed;
  top: 0;
  left: 0;
  bottom: 0;
  z-index: 10;
}

.sidebar-brand {
  padding: var(--space-4) var(--space-4);
  font-size: var(--font-size-lg);
  font-weight: var(--font-weight-bold);
  color: var(--color-primary);
  border-bottom: 1px solid var(--color-border);
}

.sidebar-nav {
  display: flex;
  flex-direction: column;
  padding: var(--space-2);
  gap: var(--space-1);
}

.sidebar-link {
  display: block;
  padding: var(--space-2) var(--space-3);
  border-radius: var(--radius-md);
  color: var(--color-text-secondary);
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
  transition: background 0.15s, color 0.15s;
  text-decoration: none;
}

.sidebar-link:hover {
  background: var(--color-bg-tertiary);
  color: var(--color-text);
}

.sidebar-link.active {
  background: var(--color-primary-light);
  color: var(--color-primary);
}

.main {
  margin-left: var(--sidebar-width);
  flex: 1;
  display: flex;
  flex-direction: column;
}

.header {
  height: var(--header-height);
  border-bottom: 1px solid var(--color-border);
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0 var(--space-6);
  background: var(--color-bg);
  position: sticky;
  top: 0;
  z-index: 5;
}

.header-title {
  font-size: var(--font-size-lg);
  font-weight: var(--font-weight-semibold);
}

.btn-logout {
  padding: var(--space-1) var(--space-3);
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
  background: none;
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  cursor: pointer;
  transition: background 0.15s, color 0.15s;
}

.btn-logout:hover {
  background: var(--color-danger-bg);
  color: var(--color-danger);
  border-color: var(--color-danger);
}

.content {
  padding: var(--space-6);
  max-width: var(--content-max-width);
  width: 100%;
}

.page h2 {
  font-size: var(--font-size-xl);
  font-weight: var(--font-weight-semibold);
  margin-bottom: var(--space-4);
}
```

**5. Update `packages/admin/src/app.tsx`:**

Replace the Plan 01 placeholder with actual Layout:

```tsx
import { isAuthenticated, daemonShutdown } from './auth/store';
import { Login } from './auth/login';
import { Layout } from './components/layout';
import { ToastContainer } from './components/toast';

function ShutdownOverlay() {
  return (
    <div style={{ position: 'fixed', inset: 0, display: 'flex', alignItems: 'center', justifyContent: 'center', background: 'rgba(0,0,0,0.7)', color: 'white', zIndex: 9999 }}>
      <div style={{ textAlign: 'center' }}>
        <h1 style={{ fontSize: '1.5rem', marginBottom: '0.5rem' }}>Daemon Shutting Down</h1>
        <p>The daemon is shutting down. Please wait or restart.</p>
      </div>
    </div>
  );
}

export function App() {
  if (daemonShutdown.value) {
    return <ShutdownOverlay />;
  }
  if (!isAuthenticated.value) {
    return <Login />;
  }
  return (
    <>
      <Layout />
      <ToastContainer />
    </>
  );
}
```
  </action>
  <verify>
1. `pnpm --filter @waiaas/admin build` completes without errors
2. Verify layout: `grep 'sidebar' packages/admin/src/components/layout.tsx && grep 'PageRouter' packages/admin/src/components/layout.tsx`
3. Verify pages exist: `ls packages/admin/src/pages/`
4. Verify utils: `grep 'formatUptime' packages/admin/src/utils/format.ts && grep 'getErrorMessage' packages/admin/src/utils/error-messages.ts`
5. Verify error message count: `grep -c ":" packages/admin/src/utils/error-messages.ts` should show 70+ lines
6. Verify app.tsx integrates Layout: `grep 'Layout' packages/admin/src/app.tsx`
  </verify>
  <done>Layout component renders sidebar with 5 nav links, header with page title and logout button, content area with hash-based page routing. All 5 page placeholders exist. Error messages map 68 server + 2 client error codes. Format utilities for uptime/date/address work correctly. App.tsx integrates Layout + ToastContainer when authenticated.</done>
</task>

<task type="auto">
  <name>Task 2: Create Reusable UI Components (Table, Form, Modal, Toast, CopyButton, EmptyState)</name>
  <files>
    packages/admin/src/components/table.tsx
    packages/admin/src/components/form.tsx
    packages/admin/src/components/modal.tsx
    packages/admin/src/components/toast.tsx
    packages/admin/src/components/copy-button.tsx
    packages/admin/src/components/empty-state.tsx
    packages/admin/src/styles/global.css
  </files>
  <action>
**1. Create `packages/admin/src/components/table.tsx`:**

Generic Table component per design doc section 9.3:

```tsx
import type { ComponentChildren } from 'preact';
```

Types:
```typescript
export interface Column<T> {
  key: string;
  header: string;
  render?: (item: T) => ComponentChildren;
  width?: string;
}

export interface TableProps<T> {
  columns: Column<T>[];
  data: T[];
  onRowClick?: (item: T) => void;
  emptyMessage?: string;
  loading?: boolean;
}
```

Component renders a `<table>` with:
- `<thead>` with column headers
- `<tbody>` with data rows
- If `loading=true`: show a row spanning all columns with "Loading..." text
- If `data.length === 0` and not loading: show the emptyMessage (default "No data") in a row spanning all columns
- Row click handler on `<tr>` if `onRowClick` provided (cursor: pointer)
- Cell rendering: If column has `render`, call `render(item)`, otherwise access `(item as any)[column.key]`

CSS classes (add to global.css):
```css
/* Table */
.table-container {
  overflow-x: auto;
}

table {
  width: 100%;
  border-collapse: collapse;
}

table th {
  text-align: left;
  padding: var(--space-2) var(--space-3);
  font-size: var(--font-size-xs);
  font-weight: var(--font-weight-semibold);
  color: var(--color-text-secondary);
  text-transform: uppercase;
  letter-spacing: 0.05em;
  border-bottom: 2px solid var(--color-border);
  background: var(--color-bg-secondary);
}

table td {
  padding: var(--space-2) var(--space-3);
  font-size: var(--font-size-sm);
  border-bottom: 1px solid var(--color-border);
}

table tbody tr:hover {
  background: var(--color-bg-secondary);
}

table tbody tr.clickable {
  cursor: pointer;
}

table .table-empty {
  text-align: center;
  color: var(--color-text-muted);
  padding: var(--space-8) var(--space-4);
}

table .table-loading {
  text-align: center;
  color: var(--color-text-muted);
  padding: var(--space-8) var(--space-4);
}
```

**2. Create `packages/admin/src/components/form.tsx`:**

Contains FormField, Button, and Badge components per design doc section 9.3.

**FormField** props:
```typescript
export interface FormFieldProps {
  label: string;
  name: string;
  type?: 'text' | 'number' | 'select' | 'textarea' | 'checkbox' | 'password';
  value: string | number | boolean;
  onChange: (value: string | number | boolean) => void;
  options?: { label: string; value: string }[];
  error?: string;
  required?: boolean;
  disabled?: boolean;
  placeholder?: string;
  min?: number;
  max?: number;
}
```

Renders: `<div class="form-field">` containing:
- `<label>` with label text (+ `*` if required)
- Input element based on type:
  - `text`/`number`/`password`: `<input>` with appropriate type
  - `select`: `<select>` with `<option>` elements from options array
  - `textarea`: `<textarea>`
  - `checkbox`: `<input type="checkbox">` (inline with label)
- Error message `<span class="form-error">` if error string provided

**Button** props:
```typescript
export interface ButtonProps {
  variant?: 'primary' | 'secondary' | 'danger' | 'ghost';
  size?: 'sm' | 'md';
  loading?: boolean;
  disabled?: boolean;
  onClick?: () => void;
  children: ComponentChildren;
  type?: 'button' | 'submit';
}
```

Renders `<button>` with CSS class `btn btn-{variant}` (default primary). When loading: text becomes "..." and disabled. Size 'sm' uses smaller padding/font.

**Badge** props:
```typescript
export interface BadgeProps {
  variant: 'success' | 'warning' | 'danger' | 'info' | 'neutral';
  children: ComponentChildren;
}
```

Renders `<span class="badge badge-{variant}">`.

CSS (add to global.css):
```css
/* Form */
.form-field {
  margin-bottom: var(--space-4);
}

.form-field label {
  display: block;
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
  color: var(--color-text);
  margin-bottom: var(--space-1);
}

.form-field input,
.form-field select,
.form-field textarea {
  width: 100%;
  padding: var(--space-2) var(--space-3);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-md);
  font-size: var(--font-size-sm);
  background: var(--color-bg);
  color: var(--color-text);
  outline: none;
  transition: border-color 0.15s;
}

.form-field input:focus,
.form-field select:focus,
.form-field textarea:focus {
  border-color: var(--color-primary);
  box-shadow: 0 0 0 2px var(--color-primary-light);
}

.form-field textarea {
  min-height: 80px;
  resize: vertical;
}

.form-field .form-error {
  display: block;
  font-size: var(--font-size-xs);
  color: var(--color-danger);
  margin-top: var(--space-1);
}

.form-field input[type="checkbox"] {
  width: auto;
  margin-right: var(--space-2);
}

/* Buttons */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-2);
  padding: var(--space-2) var(--space-4);
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
  border: 1px solid transparent;
  border-radius: var(--radius-md);
  cursor: pointer;
  transition: background 0.15s, color 0.15s, border-color 0.15s;
}

.btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

.btn-sm {
  padding: var(--space-1) var(--space-3);
  font-size: var(--font-size-xs);
}

.btn-primary {
  background: var(--color-primary);
  color: white;
}

.btn-primary:hover:not(:disabled) {
  background: var(--color-primary-hover);
}

.btn-secondary {
  background: var(--color-bg);
  color: var(--color-text);
  border-color: var(--color-border);
}

.btn-secondary:hover:not(:disabled) {
  background: var(--color-bg-secondary);
}

.btn-danger {
  background: var(--color-danger);
  color: white;
}

.btn-danger:hover:not(:disabled) {
  background: #b91c1c;
}

.btn-ghost {
  background: transparent;
  color: var(--color-text-secondary);
}

.btn-ghost:hover:not(:disabled) {
  background: var(--color-bg-tertiary);
  color: var(--color-text);
}

/* Badge */
.badge {
  display: inline-flex;
  align-items: center;
  padding: 0.125rem var(--space-2);
  font-size: var(--font-size-xs);
  font-weight: var(--font-weight-medium);
  border-radius: 9999px;
}

.badge-success {
  background: var(--color-success-bg);
  color: var(--color-success);
}

.badge-warning {
  background: var(--color-warning-bg);
  color: var(--color-warning);
}

.badge-danger {
  background: var(--color-danger-bg);
  color: var(--color-danger);
}

.badge-info {
  background: var(--color-info-bg);
  color: var(--color-info);
}

.badge-neutral {
  background: var(--color-bg-tertiary);
  color: var(--color-text-secondary);
}
```

**3. Create `packages/admin/src/components/modal.tsx`:**

Props per design doc:
```typescript
export interface ModalProps {
  open: boolean;
  title: string;
  children: ComponentChildren;
  onConfirm?: () => void;
  onCancel: () => void;
  confirmText?: string;
  cancelText?: string;
  confirmVariant?: 'primary' | 'danger';
  loading?: boolean;
}
```

Renders: When `open` is true, show fixed overlay + centered modal card. Overlay click (outside card) calls `onCancel`. Escape key press calls `onCancel` (use `useEffect` to register keydown listener). Card contains: title bar, children (body), footer with Cancel + Confirm buttons (using Button component). If `onConfirm` not provided, don't render confirm button.

CSS:
```css
/* Modal */
.modal-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 100;
}

.modal-card {
  background: var(--color-bg);
  border-radius: var(--radius-lg);
  box-shadow: var(--shadow-lg);
  width: 100%;
  max-width: 480px;
  max-height: 90vh;
  overflow-y: auto;
}

.modal-header {
  padding: var(--space-4) var(--space-6);
  border-bottom: 1px solid var(--color-border);
  font-size: var(--font-size-lg);
  font-weight: var(--font-weight-semibold);
}

.modal-body {
  padding: var(--space-4) var(--space-6);
}

.modal-footer {
  padding: var(--space-3) var(--space-6);
  border-top: 1px solid var(--color-border);
  display: flex;
  justify-content: flex-end;
  gap: var(--space-2);
}
```

**4. Create `packages/admin/src/components/toast.tsx`:**

Signal-based toast system per design doc:

```typescript
import { signal } from '@preact/signals';
import type { ComponentChildren } from 'preact';

export interface Toast {
  id: number;
  type: 'success' | 'error' | 'info' | 'warning';
  message: string;
}

const toasts = signal<Toast[]>([]);
let nextId = 0;

export function showToast(type: Toast['type'], message: string): void {
  const id = nextId++;
  toasts.value = [...toasts.value, { id, type, message }];
  setTimeout(() => {
    toasts.value = toasts.value.filter(t => t.id !== id);
  }, 5000);
}

function dismissToast(id: number): void {
  toasts.value = toasts.value.filter(t => t.id !== id);
}
```

`ToastContainer` component renders a fixed top-right container:
```tsx
export function ToastContainer() {
  if (toasts.value.length === 0) return null;
  return (
    <div class="toast-container">
      {toasts.value.map(t => (
        <div key={t.id} class={`toast toast-${t.type}`} onClick={() => dismissToast(t.id)}>
          {t.message}
        </div>
      ))}
    </div>
  );
}
```

CSS:
```css
/* Toast */
.toast-container {
  position: fixed;
  top: var(--space-4);
  right: var(--space-4);
  z-index: 200;
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
  max-width: 360px;
}

.toast {
  padding: var(--space-3) var(--space-4);
  border-radius: var(--radius-md);
  font-size: var(--font-size-sm);
  box-shadow: var(--shadow-md);
  cursor: pointer;
  animation: toast-in 0.2s ease-out;
}

@keyframes toast-in {
  from { opacity: 0; transform: translateX(100%); }
  to { opacity: 1; transform: translateX(0); }
}

.toast-success {
  background: var(--color-success-bg);
  color: var(--color-success);
  border: 1px solid var(--color-success);
}

.toast-error {
  background: var(--color-danger-bg);
  color: var(--color-danger);
  border: 1px solid var(--color-danger);
}

.toast-info {
  background: var(--color-info-bg);
  color: var(--color-info);
  border: 1px solid var(--color-info);
}

.toast-warning {
  background: var(--color-warning-bg);
  color: var(--color-warning);
  border: 1px solid var(--color-warning);
}
```

**5. Create `packages/admin/src/components/copy-button.tsx`:**

```typescript
export interface CopyButtonProps {
  value: string;
  label?: string;
}
```

Component: Button that copies `value` to clipboard. Shows "Copy" (or `label`) initially. On click, uses `navigator.clipboard.writeText(value)` with fallback via `document.execCommand('copy')`. After successful copy, shows "Copied!" for 2 seconds then reverts.

Use a local signal for the copied state:
```typescript
import { signal } from '@preact/signals';

export function CopyButton({ value, label }: CopyButtonProps) {
  const copied = signal(false);

  const handleCopy = async () => {
    try {
      await navigator.clipboard.writeText(value);
    } catch {
      // Fallback
      const ta = document.createElement('textarea');
      ta.value = value;
      ta.style.position = 'fixed';
      ta.style.left = '-9999px';
      document.body.appendChild(ta);
      ta.select();
      document.execCommand('copy');
      document.body.removeChild(ta);
    }
    copied.value = true;
    setTimeout(() => { copied.value = false; }, 2000);
  };

  return (
    <button class="btn btn-ghost btn-sm" onClick={handleCopy}>
      {copied.value ? 'Copied!' : (label ?? 'Copy')}
    </button>
  );
}
```

**IMPORTANT about signals in CopyButton**: Do NOT use module-level signals for per-instance state. Instead, use `useSignal` from `@preact/signals` (or `useState` from preact/hooks) to get instance-level state:
```typescript
import { useSignal } from '@preact/signals';
// Inside component:
const copied = useSignal(false);
```

**6. Create `packages/admin/src/components/empty-state.tsx`:**

```typescript
export interface EmptyStateProps {
  title: string;
  description?: string;
  actionLabel?: string;
  onAction?: () => void;
}
```

Renders centered message with optional action button:
```tsx
export function EmptyState({ title, description, actionLabel, onAction }: EmptyStateProps) {
  return (
    <div class="empty-state">
      <h3>{title}</h3>
      {description && <p>{description}</p>}
      {actionLabel && onAction && (
        <button class="btn btn-primary" onClick={onAction}>{actionLabel}</button>
      )}
    </div>
  );
}
```

CSS:
```css
/* Empty State */
.empty-state {
  text-align: center;
  padding: var(--space-8) var(--space-4);
  color: var(--color-text-muted);
}

.empty-state h3 {
  font-size: var(--font-size-lg);
  font-weight: var(--font-weight-semibold);
  color: var(--color-text-secondary);
  margin-bottom: var(--space-2);
}

.empty-state p {
  font-size: var(--font-size-sm);
  margin-bottom: var(--space-4);
}
```

**7. Append ALL CSS to `packages/admin/src/styles/global.css`:**

Add all the CSS from the sections above (layout, table, form, buttons, badge, modal, toast, empty-state) at the end of the global.css file that was updated in Task 1 (Plan 01). Do not duplicate the root variables or reset — just append the component styles.
  </action>
  <verify>
1. `pnpm --filter @waiaas/admin build` completes without errors
2. All component files exist: `ls packages/admin/src/components/`
3. Verify table exports: `grep 'export.*Table' packages/admin/src/components/table.tsx`
4. Verify modal exports: `grep 'export.*Modal' packages/admin/src/components/modal.tsx`
5. Verify toast exports: `grep 'showToast' packages/admin/src/components/toast.tsx`
6. Verify copy button: `grep 'clipboard' packages/admin/src/components/copy-button.tsx`
7. Verify empty state: `grep 'EmptyState' packages/admin/src/components/empty-state.tsx`
8. Verify form exports: `grep 'export.*FormField\|export.*Button\|export.*Badge' packages/admin/src/components/form.tsx`
9. Verify CSS has all component styles: `grep -c 'toast\|modal\|badge\|table\|form-field\|empty-state' packages/admin/src/styles/global.css` should show multiple matches
10. Build size: `ls -la packages/admin/dist/assets/` — JS bundle should be small (~15-20KB max)
  </verify>
  <done>Seven reusable components created: Table (generic with columns/data/loading/empty), FormField (6 input types with validation error display), Button (4 variants), Badge (5 variants), Modal (overlay with confirm/cancel), Toast (signal-based auto-dismiss), CopyButton (clipboard with fallback), EmptyState (centered message with optional action). All CSS styles appended to global.css. Build succeeds with all components bundled.</done>
</task>

</tasks>

<verification>
1. `pnpm --filter @waiaas/admin build` succeeds — all components, pages, utils compile
2. Full file tree exists:
   - `packages/admin/src/components/layout.tsx` — sidebar + header + hash router
   - `packages/admin/src/components/table.tsx` — generic Table
   - `packages/admin/src/components/form.tsx` — FormField + Button + Badge
   - `packages/admin/src/components/modal.tsx` — Modal with overlay
   - `packages/admin/src/components/toast.tsx` — ToastContainer + showToast
   - `packages/admin/src/components/copy-button.tsx` — CopyButton
   - `packages/admin/src/components/empty-state.tsx` — EmptyState
   - `packages/admin/src/utils/error-messages.ts` — 70 error code mappings
   - `packages/admin/src/utils/format.ts` — formatUptime/formatDate/formatAddress
   - `packages/admin/src/pages/dashboard.tsx` — placeholder
   - `packages/admin/src/pages/agents.tsx` — placeholder
   - `packages/admin/src/pages/sessions.tsx` — placeholder
   - `packages/admin/src/pages/policies.tsx` — placeholder
   - `packages/admin/src/pages/settings.tsx` — placeholder
   - `packages/admin/src/app.tsx` — auth guard with Layout + ToastContainer
3. CSS has complete styling for all components
4. Existing daemon tests unaffected
</verification>

<success_criteria>
- Layout renders sidebar with 5 nav links, active state highlighting, header with page title + logout button
- Hash routing switches between 5 page placeholders without page reload
- Table component renders columns, data, handles loading/empty states
- FormField supports text/number/select/textarea/checkbox/password with error display
- Button has primary/secondary/danger/ghost variants with loading state
- Badge has 5 color variants
- Modal shows overlay, handles confirm/cancel, Escape key dismiss
- Toast auto-dismisses after 5s, stacks top-right
- CopyButton copies to clipboard with visual feedback
- EmptyState shows centered message with optional action
- 68 server + 2 client error codes mapped to user-friendly messages
- formatUptime/formatDate/formatAddress produce correct output
- App.tsx integrates Layout when authenticated with ToastContainer
- Build succeeds with all modules bundled
</success_criteria>

<output>
After completion, create `.planning/phases/67-auth-api-client-components/67-02-SUMMARY.md`
</output>
