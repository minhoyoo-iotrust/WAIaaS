---
phase: 02-custody-model
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - .planning/deliverables/06-ai-agent-custody-considerations.md
autonomous: true

must_haves:
  truths:
    - "AI 에이전트와 일반 사용자의 지갑 사용 패턴 차이가 명확히 분석됨"
    - "에이전트 자율적 트랜잭션 시나리오가 정의됨"
    - "에이전트-서버 간 비밀값 분리 설계가 제안됨"
    - "장애 복구 및 키 교체 요구사항이 도출됨"
    - "자율성 제한 복합 정책(금액 한도, 화이트리스트, 시간 제어)이 설계됨"
  artifacts:
    - path: ".planning/deliverables/06-ai-agent-custody-considerations.md"
      provides: "AI 에이전트 특화 커스터디 고려사항 (CUST-02)"
      contains: "자율적 트랜잭션|에이전트-서버|장애 복구"
  key_links:
    - from: ".planning/deliverables/06-ai-agent-custody-considerations.md"
      to: ".planning/phases/02-custody-model/02-CONTEXT.md"
      via: "AI 에이전트 특화 관점 결정 반영"
    - from: ".planning/deliverables/06-ai-agent-custody-considerations.md"
      to: ".planning/phases/02-custody-model/02-RESEARCH.md"
      via: "AI Agent Specific Considerations 섹션 참조"
---

<objective>
AI 에이전트 지갑에 특화된 커스터디 고려사항을 도출하여, 기존 WaaS와의 차이점 및 설계 요구사항을 명확히 한다.

Purpose: AI 에이전트 지갑의 고유한 요구사항을 정의하여 권장 모델 제안의 근거 마련
Output: CUST-02 AI 에이전트 특화 커스터디 고려사항 문서
</objective>

<execution_context>
@/Users/minho.yoo/.claude/get-shit-done/workflows/execute-plan.md
@/Users/minho.yoo/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/REQUIREMENTS.md
@.planning/phases/02-custody-model/02-CONTEXT.md
@.planning/phases/02-custody-model/02-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: AI 에이전트 특화 커스터디 고려사항 문서 작성 (CUST-02)</name>
  <files>.planning/deliverables/06-ai-agent-custody-considerations.md</files>
  <action>
    AI 에이전트 지갑에 특화된 커스터디 고려사항을 도출하는 문서를 작성한다.

    **문서 구조:**

    1. **개요**
       - 기존 WaaS의 가정 (사람 사용자, UI 상호작용, 수동 승인)
       - AI 에이전트의 특성 (API 기반, 자율적 의사결정, 프로그래매틱 접근)
       - 핵심 과제: "자율적 운영" vs "소유자 통제권 유지" 균형

    2. **일반 사용자 vs AI 에이전트 비교 분석**
       "일반 사용자라면 X, AI 에이전트라면 Y" 형식으로 시나리오별 비교:
       | 시나리오 | 일반 사용자 | AI 에이전트 |
       - 트랜잭션 승인 방식
       - 키 접근 패턴
       - 복구 절차
       - 한도 관리
       - 장애 대응
       - 인증 방식

    3. **자율적 트랜잭션 시나리오**
       - 기본 가정: 사람 승인 없이 AI가 직접 서명/제출
       - 트랜잭션 유형별 자율성 수준:
         * 소액 송금: 완전 자율
         * 고액 송금: Owner 승인 필요
         * DeFi 상호작용: 화이트리스트 기반 자율
         * 새로운 주소 전송: 승인 필요
       - 시나리오 예시: DeFi 수익 재투자, 정기 지불, 자동 리밸런싱

    4. **자율성 제한 복합 정책 설계**
       02-CONTEXT.md 결정: "금액 한도 + 화이트리스트 + 시간 제어 등 복합 정책으로 제한"
       - **금액 한도 정책:**
         * perTransaction: 단일 트랜잭션 최대 금액
         * dailyTotal: 일일 총 한도
         * weeklyTotal: 주간 총 한도
       - **화이트리스트 정책:**
         * addresses: 허용된 수신 주소
         * programs: 허용된 프로그램 ID (DeFi 프로토콜)
         * tokens: 허용된 토큰 민트
       - **시간 제어 정책:**
         * allowedHours: UTC 기준 허용 시간대
         * cooldownSeconds: 트랜잭션 간 최소 간격
       - **에스컬레이션 정책:**
         * thresholdAmount: Owner 승인 필요 금액 기준
         * requireOwnerApproval: Owner 승인 필요 프로그램 목록

    5. **에이전트-서버 간 비밀값 분리 설계**
       02-CONTEXT.md: "에이전트만 알고 있는 값(agent secret)과 서버에서 관리하는 값의 분리 구조"
       - **설계 원칙:**
         * 어느 한쪽만으로는 유효한 서명 불가
         * 에이전트 침해 시에도 서버 협력 없이 자산 이동 불가
         * 서버 침해 시에도 에이전트 협력 없이 자산 이동 불가
       - **구현 옵션:**
         * Option A: 2-of-2 MPC (Agent + Server 키 조각)
         * Option B: KMS + Enclave (Server가 KMS로 암호화, Agent가 Enclave에서 복호화)
         * Option C: Squads 2-of-2 멀티시그 (Owner Key + Agent Key)
       - **권장:** Option C (Squads 2-of-2) - 온체인 정책 강제, 복잡도 낮음

    6. **장애 복구 메커니즘**
       02-CONTEXT.md: "에이전트 장애 시 소유자 즉각 복구와 키 교체 모두 필수"
       | 장애 유형 | 복구 방법 | 소요 시간 |
       - Agent 크래시
       - Agent 키 침해
       - Owner Key 분실
       - Server 장애
       - 네트워크 분리

    7. **위협 모델 및 대응**
       02-CONTEXT.md: "내부 위협과 외부 위협 모두 동등하게 분석"
       - **내부 위협:**
         * 에이전트 키 탈취
         * 내부자 공격 (운영자 악의)
         * 에이전트 로직 오류
       - **외부 위협:**
         * 해커 공격 (API 엔드포인트)
         * 피싱 (소유자 대상)
         * 공급망 공격 (의존성 침해)
       - **대응 방안:** 각 위협별 완화 전략

    8. **컴플라이언스 고려사항**
       02-CONTEXT.md: "GDPR, SOC2, 암호화폐 규제 등 컴플라이언스 요소"
       - GDPR: 개인정보 오프체인 저장, 삭제권 행사 가능
       - SOC2: 접근 통제, 변경 관리, 모니터링
       - 암호화폐 규제: 비수탁 모델로 규제 범위 최소화

    9. **Dual Key 아키텍처 개념 정의**
       Phase 3 아키텍처로 연결될 핵심 개념:
       - Owner Key: 소유자 통제, 자금 회수, 에이전트 중지, 키 교체
       - Agent Key: 에이전트 운영용, 정책 범위 내 자율 서명

    **참고 자료:**
    - 02-RESEARCH.md의 "AI Agent Specific Considerations" 전체
    - 02-RESEARCH.md의 "AI 에이전트 시나리오별 비교" 테이블
    - 02-RESEARCH.md의 "Agent Policy 구조" 코드 예시
    - 02-CONTEXT.md의 "AI 에이전트 특화 관점" 결정

    **작성 원칙:**
    - 기존 WaaS와의 차이점을 명확히 대비
    - "왜 AI 에이전트에게 이것이 필요한가" 근거 명시
    - 구체적인 시나리오와 정책 예시 포함
    - Phase 3 아키텍처 설계로 연결될 수 있도록 개념 정의
  </action>
  <verify>
    - 파일 생성 확인: ls -la .planning/deliverables/06-ai-agent-custody-considerations.md
    - "일반 사용자 vs AI 에이전트" 비교 테이블 포함 확인
    - 자율성 제한 정책 (금액 한도, 화이트리스트, 시간 제어) 포함 확인
    - 에이전트-서버 비밀값 분리 설계 섹션 포함 확인
    - 장애 복구 메커니즘 섹션 포함 확인
    - Dual Key 개념 정의 포함 확인
  </verify>
  <done>
    - 06-ai-agent-custody-considerations.md 파일이 생성됨
    - 일반 사용자 vs AI 에이전트 비교 분석이 포함됨
    - 자율적 트랜잭션 시나리오가 정의됨
    - 자율성 제한 복합 정책이 상세히 설계됨
    - 에이전트-서버 비밀값 분리 설계가 3가지 옵션으로 제안됨
    - 장애 복구 메커니즘이 장애 유형별로 정의됨
    - 위협 모델 및 대응 방안이 포함됨
    - Dual Key 아키텍처 개념이 정의됨
  </done>
</task>

</tasks>

<verification>
1. CUST-02 요구사항 충족:
   - AI 에이전트 지갑에 특화된 커스터디 고려사항이 도출됨
   - 기존 WaaS와의 차이점이 명확히 분석됨

2. 02-CONTEXT.md 결정 준수:
   - 자율적 트랜잭션 시나리오 기본 가정 반영
   - 금액 한도 + 화이트리스트 + 시간 제어 복합 정책 포함
   - 에이전트 장애 시 복구 및 키 교체 설계 포함
   - 에이전트-서버 비밀값 분리 구조 설계 포함
   - 내부/외부 위협 동등 분석 반영

3. Phase 3 연결성:
   - Dual Key 개념이 정의되어 Phase 3 아키텍처 설계로 연결 가능
</verification>

<success_criteria>
- [ ] 06-ai-agent-custody-considerations.md 파일 생성됨 (최소 300줄)
- [ ] 일반 사용자 vs AI 에이전트 비교 테이블 포함됨
- [ ] 자율적 트랜잭션 시나리오 4개 이상 정의됨
- [ ] 자율성 제한 정책 4가지 유형 모두 설계됨
- [ ] 에이전트-서버 비밀값 분리 설계 3가지 옵션 제안됨
- [ ] 장애 복구 메커니즘 5가지 장애 유형 정의됨
- [ ] 위협 모델이 내부/외부 각 3가지 이상 포함됨
- [ ] 모든 내용이 한글로 작성됨
</success_criteria>

<output>
After completion, create `.planning/phases/02-custody-model/02-02-SUMMARY.md`
</output>
