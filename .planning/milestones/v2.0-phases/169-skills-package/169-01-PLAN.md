---
phase: 169-skills-package
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/skills/package.json
  - packages/skills/tsconfig.json
  - packages/skills/tsconfig.build.json
  - packages/skills/src/cli.ts
  - packages/skills/src/registry.ts
  - packages/skills/skills/quickstart.skill.md
  - packages/skills/skills/wallet.skill.md
  - packages/skills/skills/transactions.skill.md
  - packages/skills/skills/policies.skill.md
  - packages/skills/skills/admin.skill.md
  - packages/skills/skills/actions.skill.md
  - packages/skills/skills/x402.skill.md
  - pnpm-workspace.yaml
  - turbo.json
autonomous: true
requirements:
  - PKG-01

must_haves:
  truths:
    - "`npx @waiaas/skills list` 명령이 7개 스킬 파일 이름과 설명을 출력한다"
    - "`npx @waiaas/skills add quickstart` 명령이 현재 디렉토리에 quickstart.skill.md 파일을 복사한다"
    - "`npx @waiaas/skills add all` 명령이 7개 스킬 파일 전부를 복사한다"
    - "`npm publish --dry-run`이 packages/skills에서 에러 없이 성공한다"
  artifacts:
    - path: "packages/skills/package.json"
      provides: "@waiaas/skills npm 패키지 정의"
      contains: "\"name\": \"@waiaas/skills\""
    - path: "packages/skills/src/cli.ts"
      provides: "npx CLI 진입점 (list/add 명령)"
      min_lines: 50
    - path: "packages/skills/src/registry.ts"
      provides: "스킬 파일 메타데이터 레지스트리"
      exports: ["SKILL_REGISTRY"]
    - path: "packages/skills/skills/quickstart.skill.md"
      provides: "번들된 스킬 파일 (quickstart)"
  key_links:
    - from: "packages/skills/src/cli.ts"
      to: "packages/skills/src/registry.ts"
      via: "import SKILL_REGISTRY"
      pattern: "import.*SKILL_REGISTRY.*from.*registry"
    - from: "packages/skills/src/cli.ts"
      to: "packages/skills/skills/*.skill.md"
      via: "fs.copyFile from skills directory"
      pattern: "copyFile|createReadStream"
    - from: "packages/skills/package.json"
      to: "packages/skills/dist/cli.js"
      via: "bin field"
      pattern: "\"bin\""
---

<objective>
@waiaas/skills npm 패키지를 생성한다. npx로 실행 가능한 CLI를 제공하여 `list` (스킬 목록 출력)와 `add <name>` (스킬 파일 복사) 명령을 지원한다.

Purpose: AI 에이전트 개발자가 `npx @waiaas/skills add quickstart`로 프로젝트에 WAIaaS 스킬 파일을 즉시 추가할 수 있도록 한다.
Output: packages/skills/ 패키지 (CLI + 스킬 파일 번들)
</objective>

<execution_context>
@/Users/minho.yoo/.claude/get-shit-done/workflows/execute-plan.md
@/Users/minho.yoo/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@skills/quickstart.skill.md
@skills/wallet.skill.md
@packages/sdk/package.json
@pnpm-workspace.yaml
@turbo.json
@package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: @waiaas/skills 패키지 scaffolding + 스킬 파일 번들링</name>
  <files>
    packages/skills/package.json
    packages/skills/tsconfig.json
    packages/skills/tsconfig.build.json
    packages/skills/src/registry.ts
    packages/skills/skills/quickstart.skill.md
    packages/skills/skills/wallet.skill.md
    packages/skills/skills/transactions.skill.md
    packages/skills/skills/policies.skill.md
    packages/skills/skills/admin.skill.md
    packages/skills/skills/actions.skill.md
    packages/skills/skills/x402.skill.md
    pnpm-workspace.yaml
    turbo.json
  </files>
  <action>
    1. **packages/skills/package.json 생성:**
       - name: "@waiaas/skills", version: "1.7.0" (다른 패키지와 동일)
       - license: "MIT", type: "module", engines: { node: ">=22.0.0" }
       - bin: { "waiaas-skills": "./dist/cli.js" } -- npx @waiaas/skills 진입점
       - files: ["dist", "skills"] -- dist(컴파일된 CLI) + skills(원본 .skill.md 파일)
       - scripts: build(tsc -p tsconfig.build.json), clean(rm -rf dist)
       - devDependencies: typescript(workspace 참조 불필요, 루트에서 제공)

    2. **tsconfig.json + tsconfig.build.json 생성:**
       - 기존 packages/sdk/tsconfig*.json 패턴을 따른다
       - target: ES2022, module: NodeNext, moduleResolution: NodeNext
       - outDir: ./dist, rootDir: ./src
       - tsconfig.build.json은 exclude: ["**/*.test.ts"]

    3. **packages/skills/src/registry.ts 생성:**
       - `SKILL_REGISTRY` 배열 export: 각 항목은 { name, filename, description }
       - 7개 항목: quickstart, wallet, transactions, policies, admin, actions, x402
       - description은 각 .skill.md의 YAML frontmatter description에서 가져옴
       - `getSkillsDir()` 함수: `path.resolve(import.meta.dirname, '../skills')` 로 skills 디렉토리 경로 반환

    4. **skills/ 디렉토리에 7개 .skill.md 파일 복사:**
       - 프로젝트 루트의 skills/*.skill.md를 packages/skills/skills/로 **심볼릭 링크가 아닌 실제 복사**
       - 이렇게 하면 npm publish 시 skills/ 디렉토리가 패키지에 포함됨
       - NOTE: 빌드 시점이 아닌, 계획 실행 시점에 복사. 추후 CI에서 sync 스크립트를 추가할 수 있으나 현재는 수동 복사로 충분.

    5. **pnpm-workspace.yaml 업데이트:**
       - packages 배열에 이미 "packages/*"가 있으므로 자동으로 포함됨. 변경 불필요.
       - 단, 확인만 하고 변경이 필요하면 추가.

    6. **turbo.json 업데이트:**
       - @waiaas/skills 패키지는 TypeScript 소스만 빌드하면 되므로 기본 build task로 충분
       - 별도 turbo config 추가 불필요 (기본 build task가 ^build 의존성으로 처리)
       - 단, skills 패키지는 다른 패키지에 의존하지 않으므로 추가 설정 불필요
  </action>
  <verify>
    - `pnpm install` 성공 (새 패키지 인식)
    - `pnpm --filter @waiaas/skills build` 성공
    - `ls packages/skills/dist/cli.js` 파일 존재
    - `ls packages/skills/skills/*.skill.md` 7개 파일 존재
  </verify>
  <done>packages/skills 패키지가 모노레포에 등록되고, 빌드 후 dist/에 CLI가, skills/에 7개 스킬 파일이 존재한다</done>
</task>

<task type="auto">
  <name>Task 2: CLI 구현 (list/add 명령) + npm publish dry-run 검증</name>
  <files>
    packages/skills/src/cli.ts
  </files>
  <action>
    1. **packages/skills/src/cli.ts 구현:**
       - `#!/usr/bin/env node` 셔뱅 라인 (빌드 후 dist/cli.js에 포함되도록)
       - process.argv 파싱 (minimist 같은 의존성 없이 직접 파싱, zero-dependency 유지)
       - 명령어:
         - `list` (또는 인자 없음): SKILL_REGISTRY를 순회하며 name + description 출력. 테이블 형식 or 리스트 형식.
         - `add <name>`: name에 해당하는 스킬 파일을 process.cwd()에 복사. 이미 존재하면 덮어쓸지 확인(--force 플래그) 또는 스킵 메시지.
         - `add all`: 7개 전부 복사.
         - `help` (또는 --help): 사용법 출력.
       - 에러 처리: 잘못된 스킬 이름 -> 존재하는 이름 목록 출력 + exit(1)
       - 색상 없음 (zero-dependency, 터미널 호환성). console.log + process.exit.
       - 복사 시 `fs.copyFileSync()` 사용 (Node.js 내장).

    2. **빌드 후 npx 시뮬레이션:**
       - `pnpm --filter @waiaas/skills build`
       - `node packages/skills/dist/cli.js list` -> 7개 스킬 목록 출력 확인
       - `node packages/skills/dist/cli.js add quickstart` -> quickstart.skill.md가 cwd에 복사 확인
       - 복사된 파일 삭제 (cleanup)

    3. **npm publish --dry-run 검증:**
       - `cd packages/skills && npm publish --dry-run` 성공 확인
       - files 필드가 dist + skills를 포함하는지 확인
  </action>
  <verify>
    - `node packages/skills/dist/cli.js list` 출력에 7개 스킬 이름이 포함
    - `node packages/skills/dist/cli.js add quickstart` 후 현재 디렉토리에 quickstart.skill.md 존재
    - `cd packages/skills && npm publish --dry-run` exit code 0
  </verify>
  <done>`npx @waiaas/skills list`와 `npx @waiaas/skills add <name>` 명령이 동작하고, npm publish --dry-run이 성공한다</done>
</task>

</tasks>

<verification>
1. `pnpm --filter @waiaas/skills build` 성공
2. `node packages/skills/dist/cli.js list` 출력에 quickstart, wallet, transactions, policies, admin, actions, x402 7개 표시
3. `node packages/skills/dist/cli.js add quickstart` -> cwd에 quickstart.skill.md 복사됨
4. `node packages/skills/dist/cli.js add all` -> cwd에 7개 .skill.md 파일 복사됨
5. `cd packages/skills && npm publish --dry-run` 성공
</verification>

<success_criteria>
- @waiaas/skills 패키지가 모노레포에 존재하고 빌드 성공
- list 명령이 7개 스킬 파일 목록을 출력
- add 명령이 스킬 파일을 cwd에 복사
- npm publish --dry-run 성공
</success_criteria>

<output>
After completion, create `.planning/phases/169-skills-package/169-01-SUMMARY.md`
</output>
