---
phase: 169-skills-package
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - examples/simple-agent/package.json
  - examples/simple-agent/tsconfig.json
  - examples/simple-agent/src/index.ts
  - examples/simple-agent/README.md
  - examples/simple-agent/.env.example
autonomous: true
requirements:
  - PKG-02

must_haves:
  truths:
    - "examples/simple-agent/ 디렉토리에 실행 가능한 에이전트 코드가 존재한다"
    - "README.md를 따라 설치하면 TypeScript 빌드가 성공한다"
    - "에이전트가 잔액 조회 -> 조건부 전송 -> 완료 대기 3단계 흐름을 실행한다"
    - "환경 변수(.env)로 데몬 URL과 세션 토큰을 설정할 수 있다"
  artifacts:
    - path: "examples/simple-agent/package.json"
      provides: "예제 에이전트 패키지 정의"
      contains: "\"@waiaas/sdk\""
    - path: "examples/simple-agent/src/index.ts"
      provides: "메인 에이전트 로직 (잔액 -> 전송 -> 대기)"
      min_lines: 60
    - path: "examples/simple-agent/README.md"
      provides: "설치/실행 안내 문서"
      min_lines: 30
    - path: "examples/simple-agent/.env.example"
      provides: "환경 변수 템플릿"
      contains: "WAIAAS_SESSION_TOKEN"
  key_links:
    - from: "examples/simple-agent/src/index.ts"
      to: "@waiaas/sdk"
      via: "import { WAIaaSClient } from '@waiaas/sdk'"
      pattern: "import.*WAIaaSClient.*from.*@waiaas/sdk"
    - from: "examples/simple-agent/src/index.ts"
      to: "getBalance -> sendToken -> getTransaction"
      via: "SDK client method chain"
      pattern: "getBalance|sendToken|getTransaction"
---

<objective>
examples/simple-agent/ 디렉토리에 @waiaas/sdk 기반 예제 에이전트를 생성한다. 잔액 조회 -> 조건부 전송 -> 완료 대기 흐름을 시연한다.

Purpose: AI 에이전트 개발자에게 SDK 사용법을 실전 코드로 보여주고, 복사-붙여넣기로 시작할 수 있는 시작점을 제공한다.
Output: examples/simple-agent/ (실행 가능한 TypeScript 예제)
</objective>

<execution_context>
@/Users/minho.yoo/.claude/get-shit-done/workflows/execute-plan.md
@/Users/minho.yoo/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@packages/sdk/src/index.ts
@packages/sdk/src/client.ts
@packages/sdk/src/types.ts
@packages/sdk/package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: examples/simple-agent 프로젝트 구조 + 에이전트 로직 구현</name>
  <files>
    examples/simple-agent/package.json
    examples/simple-agent/tsconfig.json
    examples/simple-agent/src/index.ts
    examples/simple-agent/.env.example
  </files>
  <action>
    1. **examples/simple-agent/package.json 생성:**
       - name: "waiaas-simple-agent" (npm에 publish하지 않으므로 @waiaas scope 불필요)
       - private: true, type: "module", license: "MIT"
       - scripts: build(tsc), start(node dist/index.js), dev(tsx src/index.ts)
       - dependencies: { "@waiaas/sdk": "workspace:*" } -- 모노레포 내 workspace 참조
       - devDependencies: { "typescript": "^5.7.0", "tsx": "^4.21.0", "@types/node": "^22.0.0" }
       - engines: { node: ">=22.0.0" }
       - NOTE: examples/는 pnpm-workspace.yaml에 포함되지 않으므로, 독립 프로젝트처럼 동작.
         하지만 모노레포에서 개발 시 workspace:* 참조로 로컬 SDK 사용 가능.
         외부 사용자는 "@waiaas/sdk": "^1.7.0" 으로 변경하여 npm에서 설치.

    2. **examples/simple-agent/tsconfig.json 생성:**
       - target: ES2022, module: NodeNext, moduleResolution: NodeNext
       - outDir: ./dist, rootDir: ./src
       - strict: true, esModuleInterop: true

    3. **examples/simple-agent/.env.example 생성:**
       ```
       # WAIaaS daemon URL
       WAIAAS_BASE_URL=http://localhost:3100
       # Session token (from POST /v1/sessions)
       WAIAAS_SESSION_TOKEN=wai_sess_...
       # Minimum balance threshold for sending (in lamports or wei)
       MIN_BALANCE_THRESHOLD=1000000
       # Recipient address
       RECIPIENT_ADDRESS=
       # Amount to send (in human-readable units, e.g., "0.001")
       SEND_AMOUNT=0.001
       ```

    4. **examples/simple-agent/src/index.ts 구현:**
       - `import { WAIaaSClient, WAIaaSError } from '@waiaas/sdk'` 사용
       - 환경변수 로딩: process.env에서 직접 읽기 (dotenv 의존성 추가하지 않음, Node 22의 --env-file 사용 안내)
       - **main() async 함수:**
         - Step 1: WAIaaSClient 생성 (baseUrl, sessionToken from env)
         - Step 2: 잔액 조회 `client.getBalance()` -> 잔액과 심볼 출력
         - Step 3: 조건부 판단 -- 잔액이 MIN_BALANCE_THRESHOLD 이상이면 전송 진행, 미만이면 "잔액 부족" 메시지 출력 후 종료
         - Step 4: `client.sendToken({ type: 'TRANSFER', to: recipientAddress, amount: sendAmount })` 호출
         - Step 5: 응답에서 transactionId 추출
         - Step 6: 폴링 루프로 트랜잭션 완료 대기 -- `client.getTransaction(txId)`를 1초 간격으로 호출하여 status가 'COMPLETED' 또는 'FAILED'가 될 때까지 대기 (최대 60초 타임아웃)
         - Step 7: 최종 상태 출력 (성공/실패/타임아웃)
       - **에러 처리:**
         - WAIaaSError catch -> error.code, error.message 출력
         - 일반 Error catch -> stack trace 출력
       - **로깅:** console.log으로 각 단계마다 진행 상황 출력 (에이전트 관점의 "사고" 과정)
         - 예: "[Agent] Checking wallet balance...", "[Agent] Balance: 0.5 SOL", "[Agent] Sending 0.001 SOL to ...", "[Agent] Waiting for confirmation..."
       - process.exit(0) on success, process.exit(1) on failure
  </action>
  <verify>
    - `cd examples/simple-agent && npx tsc --noEmit` TypeScript 타입 체크 성공
    - src/index.ts에 getBalance, sendToken, getTransaction 3개 SDK 메서드 호출이 존재
    - .env.example에 5개 환경 변수가 정의되어 있음
  </verify>
  <done>examples/simple-agent/에 TypeScript 빌드 가능한 SDK 기반 에이전트가 존재하고, 잔액 조회 -> 조건부 전송 -> 완료 대기 3단계 흐름을 실행한다</done>
</task>

<task type="auto">
  <name>Task 2: README.md 작성 + 빌드 검증</name>
  <files>
    examples/simple-agent/README.md
  </files>
  <action>
    1. **examples/simple-agent/README.md 작성 (영문):**
       - Title: "WAIaaS Simple Agent Example"
       - Description: SDK를 사용한 간단한 AI 에이전트 예제. 잔액 조회, 조건부 전송, 트랜잭션 완료 대기를 시연.
       - **Prerequisites** 섹션:
         - Node.js >= 22
         - WAIaaS daemon 실행 중 (http://localhost:3100)
         - 지갑 생성 + 세션 토큰 발급 완료 (quickstart.skill.md 참조)
       - **Setup** 섹션:
         ```
         # From monorepo root
         pnpm install
         cd examples/simple-agent
         cp .env.example .env
         # Edit .env with your session token and recipient address
         ```
       - **Run** 섹션:
         ```
         # With Node.js 22 --env-file flag
         node --env-file=.env dist/index.js

         # Or with tsx for development
         npx tsx --env-file=.env src/index.ts
         ```
       - **Standalone Usage** 섹션 (모노레포 외부에서 사용 시):
         ```
         mkdir my-agent && cd my-agent
         npm init -y
         npm install @waiaas/sdk
         # Copy src/index.ts and adapt
         ```
       - **What It Does** 섹션: 3단계 흐름 설명 (check balance -> conditional send -> wait for confirmation)
       - **Customization** 섹션: 환경변수 설명 테이블

    2. **빌드 검증:**
       - examples/simple-agent는 pnpm-workspace에 포함되지 않으므로, workspace:* 참조가 npm publish에 영향 없음 확인
       - 단, 모노레포 내에서 개발 시 `pnpm install`로 심볼릭 링크가 연결되는지 확인. 안 되면 pnpm-workspace.yaml에 "examples/*" 추가 고려 (단, private: true이므로 publish 문제 없음)
       - 최종적으로 `npx tsc --noEmit`으로 타입 체크만 확인 (실제 데몬 없이 실행 불가하므로)
  </action>
  <verify>
    - README.md에 Prerequisites, Setup, Run, Standalone Usage, What It Does, Customization 섹션이 존재
    - README.md 라인 수 >= 30
  </verify>
  <done>examples/simple-agent/README.md가 설치/실행 방법을 안내하고, 프로젝트가 TypeScript 빌드에 성공한다</done>
</task>

</tasks>

<verification>
1. examples/simple-agent/package.json에 @waiaas/sdk 의존성 존재
2. examples/simple-agent/src/index.ts에서 WAIaaSClient import + getBalance + sendToken + getTransaction 호출
3. examples/simple-agent/README.md에 Prerequisites, Setup, Run 섹션 존재
4. examples/simple-agent/.env.example에 WAIAAS_BASE_URL, WAIAAS_SESSION_TOKEN 등 환경변수 정의
5. TypeScript 타입 체크 성공 (npx tsc --noEmit)
</verification>

<success_criteria>
- examples/simple-agent/ 디렉토리에 실행 가능한 에이전트 프로젝트 존재
- SDK 기반 잔액 조회 -> 조건부 전송 -> 완료 대기 3단계 흐름 구현
- README.md에 설치/실행 안내 완비
- TypeScript 빌드 성공
</success_criteria>

<output>
After completion, create `.planning/phases/169-skills-package/169-02-SUMMARY.md`
</output>
