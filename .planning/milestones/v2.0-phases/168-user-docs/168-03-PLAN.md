---
phase: 168-user-docs
plan: 03
type: execute
wave: 2
depends_on:
  - 168-01
files_modified:
  - docs/deployment.md
  - docs/api-reference.md
  - CHANGELOG.md
autonomous: true
requirements:
  - DOC-05
  - DOC-06
  - DOC-07

must_haves:
  truths:
    - "배포 가이드가 npm global install 경로와 Docker compose 경로 두 가지를 모두 안내한다"
    - "API 레퍼런스가 OpenAPI 3.0 스펙 기반으로 엔드포인트 목록과 인증 방식을 설명한다"
    - "CHANGELOG.md가 v1.1~v2.0 전체 주요 변경 이력을 Keep a Changelog 포맷으로 포함한다"
  artifacts:
    - path: "docs/deployment.md"
      provides: "배포 가이드 (CLI + Docker)"
      contains: "npm install -g"
      min_lines: 80
    - path: "docs/api-reference.md"
      provides: "API 레퍼런스 (OpenAPI 기반)"
      contains: "OpenAPI"
      min_lines: 60
    - path: "CHANGELOG.md"
      provides: "전체 변경 이력"
      contains: "v1.1"
      min_lines: 100
  key_links:
    - from: "README.md"
      to: "docs/deployment.md"
      via: "documentation link"
      pattern: "docs/deployment"
    - from: "README.md"
      to: "docs/api-reference.md"
      via: "documentation link"
      pattern: "docs/api-reference"
---

<objective>
배포 가이드, API 레퍼런스, CHANGELOG를 작성한다.

Purpose: 외부 사용자가 프로젝트를 설치/배포하고, API를 참조하고, 버전별 변경 사항을 파악할 수 있는 문서를 제공한다.
Output: docs/deployment.md, docs/api-reference.md, CHANGELOG.md
</objective>

<execution_context>
@/Users/minho.yoo/.claude/get-shit-done/workflows/execute-plan.md
@/Users/minho.yoo/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/168-user-docs/168-01-SUMMARY.md
@objectives/v2.0-release.md (섹션 3.1~3.2 참조)
@docker-compose.yml
@docker-compose.secrets.yml
@Dockerfile
@packages/daemon/src/api/index.ts
@packages/daemon/src/api/routes/
@packages/core/src/schemas/
</context>

<tasks>

<task type="auto">
  <name>Task 1: 배포 가이드 (docs/deployment.md) 작성</name>
  <files>
    docs/deployment.md
  </files>
  <action>
docs/deployment.md를 영문으로 작성한다. 구조:

1. **Deployment Guide** (제목)
2. **Prerequisites**: Node.js 22 LTS, Docker (Docker 경로용)
3. **Option A: npm Global Install** (CLI 기반):
   - `npm install -g @waiaas/cli`
   - `waiaas init` (데이터 디렉토리 + 키스토어 초기화, 마스터 패스워드 설정)
   - `waiaas start` (데몬 시작)
   - `waiaas status` (상태 확인)
   - 데이터 디렉토리 위치: `~/.waiaas/`
   - 업그레이드: `waiaas upgrade` 또는 `npm install -g @waiaas/cli@latest`
4. **Option B: Docker Compose**:
   - docker-compose.yml 예제 (실제 프로젝트의 docker-compose.yml을 참조하여 작성)
   - 환경변수 설정 (WAIAAS_DAEMON_PORT, WAIAAS_DAEMON_MASTER_PASSWORD_HASH 등)
   - docker-compose.secrets.yml 시크릿 파일 방식 안내
   - 볼륨 마운트: data + config
   - `docker compose up -d`
   - 로그 확인: `docker compose logs -f waiaas`
   - 업그레이드: `docker compose pull && docker compose up -d`
5. **Configuration**:
   - config.toml 위치 및 주요 설정 항목 요약 (daemon, rpc, security 섹션)
   - 환경변수 오버라이드 패턴: `WAIAAS_{SECTION}_{KEY}`
   - Admin Settings (런타임 변경 가능 설정)
6. **Post-Installation**:
   - Admin UI 접속: `http://127.0.0.1:3100/admin`
   - 첫 지갑 생성 (curl 예제)
   - 세션 토큰 발급 (curl 예제)
   - MCP 연동: `waiaas mcp setup`
7. **Notifications Setup** (간단 요약 + 각 채널 설정 방법 링크)
8. **Security Checklist**: localhost만 바인딩, 마스터 패스워드 강도, 알림 채널 2개 이상 설정 권장
9. **Troubleshooting**: 포트 충돌, 권한 오류, DB 마이그레이션 자동 실행 안내

Dockerfile과 docker-compose.yml을 실제로 읽어서 정확한 설정을 반영한다.
  </action>
  <verify>
    - `grep -c "npm install -g" docs/deployment.md` >= 1
    - `grep -c "docker compose" docs/deployment.md` >= 1
    - `wc -l docs/deployment.md` >= 80
  </verify>
  <done>
    배포 가이드가 npm global install과 Docker compose 두 경로를 모두 안내하고, 설치 후 첫 사용까지의 전체 과정을 포함한다
  </done>
</task>

<task type="auto">
  <name>Task 2: API 레퍼런스 (docs/api-reference.md) + CHANGELOG.md 작성</name>
  <files>
    docs/api-reference.md
    CHANGELOG.md
  </files>
  <action>
**docs/api-reference.md** -- 영문으로 작성한다. 구조:

1. **API Reference** (제목)
2. **Base URL**: `http://127.0.0.1:3100` (localhost 전용)
3. **Authentication** (3가지 방식):
   - masterAuth: `X-Master-Password` 헤더 (시스템 관리)
   - sessionAuth: `Authorization: Bearer wai_sess_...` (에이전트 접근)
   - ownerAuth: `X-Owner-Signature` + `X-Owner-Message` 헤더 (자금 소유자)
4. **OpenAPI Specification**:
   - 데몬 실행 중 `GET /doc` 에서 OpenAPI 3.0 JSON 스펙 접근 가능
   - Swagger UI: 데몬이 자동으로 `/doc` 또는 `/reference` 엔드포인트에서 렌더링
   - 스펙 파일 위치: `packages/daemon/src/api/routes/` 에서 Hono OpenAPI 데코레이터로 정의
5. **Endpoint Summary** (카테고리별 테이블):
   - **System**: GET /health, GET /doc
   - **Wallets**: GET/POST /v1/wallets, GET/DELETE /v1/wallets/:id, ...
   - **Sessions**: GET/POST /v1/sessions, DELETE /v1/sessions/:id, POST /v1/sessions/:id/renew, ...
   - **Transactions**: POST /v1/transactions, GET /v1/transactions, GET /v1/transactions/:id, POST /v1/transactions/:id/cancel, POST /v1/transactions/:id/approve, ...
   - **Policies**: GET/PUT /v1/policies, ...
   - **Admin**: POST /v1/admin/kill-switch, GET /v1/admin/settings, ...
   - **Notifications**: GET/POST /v1/admin/notifications/...
   - 실제 라우트 파일을 읽어서 정확한 엔드포인트 목록을 작성한다
6. **Error Codes** (주요 에러 코드 테이블 -- 전체 83개 중 자주 사용되는 20개 정도 나열, 나머지는 OpenAPI 스펙 참조 안내)
7. **SDKs** (TypeScript SDK + Python SDK + MCP 도구 목록 간략 안내, 각 패키지 README 링크)

**주의**: 모든 엔드포인트를 수동으로 문서화하지 않는다. OpenAPI 3.0 스펙이 SSoT이므로, API 레퍼런스 문서는 스펙 접근 방법, 인증 방식, 카테고리별 엔드포인트 요약을 제공하고, 상세는 OpenAPI 스펙으로 안내한다.

**CHANGELOG.md** -- Keep a Changelog 포맷으로 작성한다.

1. 헤더: "# Changelog" + "All notable changes to this project will be documented in this file." + Keep a Changelog 링크 + Semantic Versioning 링크
2. v1.1 ~ v1.8 마일스톤별 주요 변경 사항을 역순(최신 먼저)으로 기재한다:
   - `## [Unreleased]` (v2.0 준비 중인 변경 사항)
   - `## [1.8.0] - 2026-02-17` (업그레이드 + 배포 인프라)
   - `## [1.7.0] - 2026-02-17` (품질 강화 + CI/CD)
   - `## [1.6.1] - 2026-02-16` (WalletConnect Owner 승인)
   - `## [1.6.0] - 2026-02-16` (운영 인프라 + 잔액 모니터링)
   - ... 계속 v1.1까지
   - 각 버전에서 Added / Changed / Fixed / Security 카테고리별로 3-7개 핵심 변경 사항 기재
3. 수치: MEMORY.md의 마일스톤 이력과 objectives/ 디렉토리의 objective 문서를 참조하여 정확한 내용 기재
4. release-please가 자동 생성하는 CHANGELOG와 병합 가능한 포맷 유지

**주의**: CHANGELOG의 상세 내용은 각 마일스톤의 핵심 기능/수정 사항만 포함한다. 100+ 줄 이상이되 과도하게 길지 않게 (각 버전 5-10줄) 작성한다.
  </action>
  <verify>
    - `grep -c "OpenAPI" docs/api-reference.md` >= 2
    - `grep -c "/v1/" docs/api-reference.md` >= 10 (엔드포인트 목록)
    - `grep "masterAuth\\|X-Master-Password" docs/api-reference.md` 결과 존재
    - `grep "## \[1.1" CHANGELOG.md` 결과 존재 (v1.1 항목)
    - `grep "## \[1.8" CHANGELOG.md` 결과 존재 (v1.8 항목)
    - `wc -l CHANGELOG.md` >= 100
    - `wc -l docs/api-reference.md` >= 60
  </verify>
  <done>
    API 레퍼런스가 OpenAPI 3.0 스펙 기반으로 인증 방식, 엔드포인트 카테고리별 요약, 에러 코드를 제공하고, CHANGELOG가 v1.1~v2.0 전체 주요 변경 이력을 Keep a Changelog 포맷으로 포함한다
  </done>
</task>

</tasks>

<verification>
1. `test -f docs/deployment.md && echo "PASS"` -> PASS
2. `test -f docs/api-reference.md && echo "PASS"` -> PASS
3. `test -f CHANGELOG.md && echo "PASS"` -> PASS
4. `grep "npm install -g" docs/deployment.md` -> 존재
5. `grep "docker compose" docs/deployment.md` -> 존재
6. `grep "OpenAPI" docs/api-reference.md` -> 존재
7. `grep "## \[1.1" CHANGELOG.md` -> 존재
8. 모든 파일 최소 줄 수 충족
</verification>

<success_criteria>
- docs/deployment.md가 CLI(npm global) 설치와 Docker(compose) 설치 두 경로를 모두 안내
- docs/api-reference.md가 OpenAPI 3.0 스펙 기반으로 인증 방식과 엔드포인트 요약 제공
- CHANGELOG.md가 v1.1~v2.0 전체 주요 변경 이력을 Keep a Changelog 포맷으로 포함
- README.md에서 이 문서들로의 링크가 올바르게 작동 (Plan 02에서 README에 링크 포함)
</success_criteria>

<output>
After completion, create `.planning/phases/168-user-docs/168-03-SUMMARY.md`
</output>
