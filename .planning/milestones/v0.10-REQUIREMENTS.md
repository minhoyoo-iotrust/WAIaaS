# Requirements Archive: v0.10 구현 전 설계 완결성 확보

**Archived:** 2026-02-09
**Status:** SHIPPED

For current requirements, see `.planning/REQUIREMENTS.md`.

---

# Requirements: WAIaaS v0.10

**Defined:** 2026-02-09
**Core Value:** 구현 착수 차단 미비점 12건을 해소하여, 설계 문서만으로 코드를 작성할 수 있는 상태를 만든다

## v0.10 Requirements

설계 문서 간 교차 지점에서 구현자가 추측해야 하는 BLOCKING 4건 + HIGH 8건을 해소한다.

### 정책 엔진 완결

- [x] **PLCY-01**: 25-sqlite §4.4 `rules` 컬럼의 "LOCK-MECH Phase에서 확정" 이연 표기를 제거하고, 33-time-lock §2.2 PolicyRuleSchema를 SSoT로 참조한다
- [x] **PLCY-02**: 34-owner §10에 GRACE 기간 정책(무기한)과 LOCKED 전이 트리거(ownerAuth Step 8.5 단일)를 명시하고, 33-time-lock §11.6 다운그레이드와의 우선순위를 확정한다
- [x] **PLCY-03**: 33-time-lock §4에 APPROVAL 타임아웃 결정 순서(정책별 > 글로벌 config > 하드코딩 3600초)를 명시한다

### 에러 처리 체계 완결

- [x] **ERRH-01**: 37-rest-api §3.3에 64개 에러 코드 전수에 대한 HTTP status + retryable + backoff 매핑 통합 매트릭스를 추가한다 ✓ (66개로 확대, SS10.12 SSoT)
- [x] **ERRH-02**: 27-chain-adapter §5에 ChainError category(PERMANENT/TRANSIENT/STALE) 분류와 카테고리별 복구 전략을 추가한다 ✓
- [x] **ERRH-03**: 37-rest-api §8.9의 PolicyType enum을 4개에서 10개로 확장하고, type별 rules 검증 분기를 명시한다 ✓

### 동시성 + 실행 로직 완결

- [x] **CONC-01**: 32-pipeline §5에 Stage 5 완전 의사코드(build→simulate→sign→submit + 에러 분기)와 티어별 타임아웃(INSTANT/NOTIFY=30초, DELAY/APPROVAL=60초)을 추가한다 ✓
- [x] **CONC-02**: 53-session-renewal §5에 낙관적 잠금(token_hash WHERE 조건) + RENEWAL_CONFLICT(409) 에러를 추가한다 ✓
- [x] **CONC-03**: 36-killswitch §3.1의 모든 상태 전이에 `WHERE value = :expectedState` 조건을 포함한 ACID 패턴을 추가한다 ✓

### 운영 로직 완결

- [x] **OPER-01**: 28-daemon §2에 6단계 시작 절차 타임아웃(각 5~30초, 전체 90초 상한)과 fail-fast/soft 정책을 테이블로 추가한다 ✓
- [x] **OPER-02**: 60-batch-tx §4에 부모-자식 2계층 DB 저장 전략과 PARTIAL_FAILURE 상태를 추가하고, 25-sqlite에 parent_id + batch_index 컬럼을 추가한다 ✓
- [x] **OPER-03**: 61-price-oracle §3.6에 다중 소스 10% 괴리 시 보수적 선택 로직과 stale(>30분) 가격 시 USD 평가 스킵 정책을 추가한다 ✓

## Future Requirements

(v1.0에서 정의 — 구현 로드맵 v1.1~v2.0)

## Out of Scope

| Feature | Reason |
|---------|--------|
| 실제 코드 구현 | 설계 보완 마일스톤 — 코드는 v1.1부터 |
| 새로운 인터페이스/테이블 추가 | parent_id/batch_index 2개 컬럼 제외, 기존 구조 유지 |
| 아키텍처 수준 변경 | 기존 설계를 수정하되 구조를 변경하지 않음 |
| MEDIUM 6건 (M1~M6) | 구현 Phase에서 인라인 Tier 1 수정으로 처리 |
| 설계 문서 41~51 갱신 | v1.1 Enum SSoT 구현 시 동기화 |

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| PLCY-01 | Phase 41 | Complete |
| PLCY-02 | Phase 41 | Complete |
| PLCY-03 | Phase 41 | Complete |
| ERRH-01 | Phase 42 | Complete |
| ERRH-02 | Phase 42 | Complete |
| ERRH-03 | Phase 42 | Complete |
| CONC-01 | Phase 43 | Complete |
| CONC-02 | Phase 43 | Complete |
| CONC-03 | Phase 43 | Complete |
| OPER-01 | Phase 44 | Complete |
| OPER-02 | Phase 44 | Complete |
| OPER-03 | Phase 44 | Complete |

**Coverage:**
- v0.10 requirements: 12 total
- Mapped to phases: 12
- Unmapped: 0 ✓

---
*Requirements defined: 2026-02-09*
*Last updated: 2026-02-09 after initial definition*
