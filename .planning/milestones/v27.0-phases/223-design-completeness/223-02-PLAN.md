---
phase: 223-design-completeness
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - internal/design/76-incoming-transaction-monitoring.md
autonomous: true
requirements:
  - VER-01
gap_closure: true

must_haves:
  truths:
    - "§8.6 영향 분석 테이블의 doc 31 행에 PATCH /v1/wallet/:id monitorIncoming 변경이 기재됨"
    - "§8.11 skills/ 파일 업데이트 요구사항 소섹션이 존재하며 wallet.skill.md 변경 범위가 명세됨"
    - "skills/ 파일 자체는 수정하지 않고 구현 마일스톤에서 수정할 범위만 명세됨"
  artifacts:
    - path: "internal/design/76-incoming-transaction-monitoring.md"
      provides: "doc 31 PATCH 영향 분석 + skills/ 업데이트 요구사항이 보완된 설계 문서"
      contains: "PATCH /v1/wallet/:id"
  key_links:
    - from: "§8.6 doc 31 영향 분석"
      to: "§7.3 PATCH /v1/wallet/:id 명세"
      via: "monitorIncoming 필드 추가 참조"
      pattern: "PATCH.*monitorIncoming"
    - from: "§8.11 skills/ 업데이트 요구사항"
      to: "skills/wallet.skill.md"
      via: "구현 마일스톤에서 업데이트할 범위 명세"
      pattern: "wallet\\.skill\\.md"
---

<objective>
§8.6 기존 설계 문서 영향 분석에서 누락된 doc 31 PATCH /v1/wallet/:id 변경을 추가하고, §8.11 신규 소섹션으로 skills/ 파일 업데이트 요구사항을 명세한다.

Purpose: VER-01 요구사항(기존 설계 문서 영향 분석 완전성)을 충족하고, CLAUDE.md의 Interface Sync 규칙에 따른 skills/ 업데이트 범위를 설계 시점에 명시하여 구현 마일스톤에서 누락 방지.
Output: doc 76의 §8.6 보완 + §8.11 신규 섹션이 추가된 설계 문서.
</objective>

<execution_context>
@/Users/minho.yoo/.claude/get-shit-done/workflows/execute-plan.md
@/Users/minho.yoo/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/223-design-completeness/223-RESEARCH.md
@internal/design/76-incoming-transaction-monitoring.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: §8.6 doc 31 PATCH 영향 분석 보완 + §8.11 skills/ 업데이트 요구사항 추가</name>
  <files>internal/design/76-incoming-transaction-monitoring.md</files>
  <action>
**§8.6 영향 분석 테이블 수정:**

doc 31 행의 "변경 내용" 열을 확장한다. 현재 상태가 "GET /v1/wallet/incoming, GET /v1/wallet/incoming/summary 엔드포인트 추가"만 기재되어 있을 경우, 다음을 추가:

```
PATCH /v1/wallet/:id monitorIncoming 필드 추가 (기존 지갑 업데이트 API 확장, masterAuth 인증, WalletUpdateSchema 확장, syncSubscriptions 호출로 구독 동적 변경)
```

영향 범위도 "엔드포인트 추가"에서 "엔드포인트 추가 + 기존 API 확장"으로 변경하여 신규 추가(GET)와 기존 확장(PATCH)이 구분됨을 명시한다.

**§8.11 skills/ 파일 업데이트 요구사항 신규 섹션 추가:**

§8.10 (또는 마지막 8.x 소섹션) 뒤에 새로운 소섹션을 추가한다:

```markdown
### 8.11 skills/ 파일 업데이트 요구사항

CLAUDE.md "Interface Sync" 규칙에 따라, 구현 마일스톤(m27-01)에서 다음 skill 파일을 업데이트한다.

> **시점:** API가 실제 구현된 후 동기화. 설계 시점에서는 범위만 명세한다.

| skill 파일 | 변경 내용 |
|------------|-----------|
| `wallet.skill.md` | "Wallet Query" 섹션에 `GET /v1/wallet/incoming` (수신 이력 조회), `GET /v1/wallet/incoming/summary` (수신 집계) 추가. `PATCH /v1/wallet/:id` monitorIncoming 필드 추가. MCP 도구 `list_incoming_transactions`, `get_incoming_summary` 추가. SDK 메서드 `listIncomingTransactions`, `getIncomingTransactionSummary` 추가. 알림 카테고리 테이블에 `incoming` 카테고리 추가 (`INCOMING_TX_DETECTED`, `INCOMING_TX_SUSPICIOUS` 이벤트). |
| `transactions.skill.md` | 변경 없음 -- 수신 TX는 아웃고잉 TX 5-type과 별개 도메인이므로 `wallet.skill.md`에 배치. |

**규칙 참조:** CLAUDE.md "Interface Sync" 섹션 -- REST API/SDK/MCP 변경 시 skills/ 동기화 필수.
```

**중요:** skills/wallet.skill.md이나 skills/transactions.skill.md 파일 자체는 수정하지 않는다. 아직 구현되지 않은 API의 skill 파일을 업데이트하면 에이전트가 존재하지 않는 MCP 도구를 호출하여 실패할 수 있다. 구현 마일스톤에서 수정할 범위만 명세한다.
  </action>
  <verify>
doc 76에서 다음을 grep으로 확인:
- §8.6 doc 31 행에 "PATCH" 키워드 존재
- §8.6 doc 31 행에 "monitorIncoming" 키워드 존재
- "8.11" 소섹션 헤더가 존재
- "wallet.skill.md" 키워드가 §8.11에 존재
- "transactions.skill.md" 키워드가 §8.11에 존재하며 "변경 없음" 표시
- skills/ 디렉토리의 파일이 수정되지 않음 (git status로 확인)
  </verify>
  <done>
§8.6 doc 31 행에 PATCH /v1/wallet/:id monitorIncoming 변경이 인증/스키마/동적 효과와 함께 기재됨. §8.11 skills/ 파일 업데이트 요구사항이 wallet.skill.md (API/MCP/SDK/알림 6개 항목) + transactions.skill.md (변경 없음)으로 명세됨. skills/ 파일 자체는 미수정.
  </done>
</task>

</tasks>

<verification>
1. §8.6 영향 분석 테이블의 doc 31 행에 PATCH /v1/wallet/:id monitorIncoming 변경이 masterAuth, WalletUpdateSchema 확장, syncSubscriptions 호출과 함께 기재됨
2. §8.11 소섹션이 존재하며 "skills/ 파일 업데이트 요구사항" 제목을 가짐
3. §8.11에 wallet.skill.md 변경 범위가 API 2개 + MCP 도구 2개 + SDK 메서드 2개 + 알림 카테고리 1개로 구체적으로 명세됨
4. §8.11에 transactions.skill.md가 "변경 없음"으로 명시되고 그 이유(별개 도메인)가 기재됨
5. §8.11에 "구현 마일스톤에서 API 구현 후 동기화" 시점이 명시됨
6. skills/ 디렉토리의 실제 파일이 수정되지 않음
</verification>

<success_criteria>
- doc 31 PATCH 해결: §8.6 영향 분석에 PATCH /v1/wallet/:id monitorIncoming 변경이 완전히 기재됨
- skills/ 해결: §8.11 소섹션에 구현 마일스톤에서 업데이트할 skill 파일과 구체적 변경 내용이 명세됨
- skills/ 파일 자체는 미수정 (설계 시점 원칙 준수)
</success_criteria>

<output>
After completion, create `.planning/phases/223-design-completeness/223-02-SUMMARY.md`
</output>
