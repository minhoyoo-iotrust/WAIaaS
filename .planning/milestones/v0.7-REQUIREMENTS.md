# Requirements Archive: v0.7 구현 장애 요소 해소

**Archived:** 2026-02-08
**Status:** SHIPPED

This is the archived requirements specification for v0.7.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone).

---

# Requirements: WAIaaS v0.7 구현 장애 요소 해소

**Defined:** 2026-02-08
**Core Value:** 코드 작성 전에 "설계대로 구현하면 동작하지 않는 부분" 25건을 제거하여, 구현 첫날부터 차단 없이 진행할 수 있는 상태를 만든다.

## v0.7 Requirements

v0.1~v0.6 설계 문서 전수 분석에서 도출된 구현 장애 요소 25건. 기존 설계 문서(24~64번)를 직접 수정하여 해소한다.

### 체인 어댑터 & 트랜잭션 안정성

- [x] **CHAIN-01**: Solana blockhash freshness guard — signTransaction() 직전 잔여 수명 < 20초이면 blockhash 갱신, UnsignedTransaction에 refreshBlockhash() 추가 [CRITICAL] — ✓ Phase 26
- [x] **CHAIN-02**: IChainAdapter에 getCurrentNonce/resetNonceTracker 2개 메서드 추가 (17→19개), UnsignedTransaction.nonce 명시적 optional 필드 승격 [CRITICAL] — ✓ Phase 26
- [x] **CHAIN-03**: Keystore AES-256-GCM nonce 충돌 확률 Birthday Problem 계산을 정확한 수학적 근거로 정정 [CRITICAL] — ✓ Phase 26
- [x] **CHAIN-04**: Priority fee 캐시 TTL 30초 근거 명시 (Nyquist 기준) + 제출 실패 시 1.5배 fee bump 1회 재시도 전략 추가 [MEDIUM] — ✓ Phase 26

### 데몬 프로세스 & 보안 기반

- [x] **DAEMON-01**: JWT Secret dual-key rotation 메커니즘 — current/previous 5분 전환 윈도우 [CRITICAL] — ✓ Phase 27
- [x] **DAEMON-02**: 데몬 인스턴스 잠금을 PID 파일에서 flock 기반으로 전환 [CRITICAL] — ✓ Phase 27
- [x] **DAEMON-03**: Rate Limiter 2단계 분리 — globalRateLimit + sessionRateLimit [HIGH] — ✓ Phase 27
- [x] **DAEMON-04**: killSwitchGuard 허용 엔드포인트 4개 확정, 503 SYSTEM_LOCKED [HIGH] — ✓ Phase 27
- [x] **DAEMON-05**: Master Password 인증을 Argon2id로 통일 [HIGH] — ✓ Phase 27
- [x] **DAEMON-06**: 단일 데몬 인스턴스 강제 — flock + 선택적 SQLite nonce 저장 [HIGH] — ✓ Phase 27

### 의존성 & 빌드 환경

- [x] **DEPS-01**: SIWE 검증을 viem v2.x 내장으로 전환, ethers/siwe 제거 [CRITICAL] — ✓ Phase 28
- [x] **DEPS-02**: Sidecar 크로스 컴파일 전략 — 5개 타겟 플랫폼 확정 [MEDIUM] — ✓ Phase 28

### API & 통합 프로토콜

- [x] **API-01**: Tauri sidecar 종료 타임아웃 35초 + SQLite integrity_check [CRITICAL] — ✓ Phase 29
- [x] **API-02**: Tauri CORS Origin에 Windows용 추가 [HIGH] — ✓ Phase 29
- [x] **API-03**: Owner disconnect cascade 5단계 확정 [HIGH] — ✓ Phase 29
- [x] **API-04**: TransactionType × Tier HTTP 응답 status 매트릭스 [HIGH] — ✓ Phase 29
- [x] **API-05**: waiaas init idempotent + --json [HIGH] — ✓ Phase 29
- [x] **API-06**: Python SDK snake_case 변환 규칙 SSoT [MEDIUM] — ✓ Phase 29
- [x] **API-07**: @waiaas/core Zod 스키마 export 패턴 [MEDIUM] — ✓ Phase 29

### 스키마 & 설정

- [x] **SCHEMA-01**: config.toml 환경변수 매핑 규칙 평탄화 [HIGH] — ✓ Phase 30
- [x] **SCHEMA-02**: SQLite 타임스탬프 전체 초 단위 통일 [HIGH] — ✓ Phase 30
- [x] **SCHEMA-03**: agents 테이블 chain/network CHECK 제약조건 [MEDIUM] — ✓ Phase 30
- [x] **SCHEMA-04**: Docker 볼륨 UID 1001 Dockerfile 명시 [MEDIUM] — ✓ Phase 30
- [x] **SCHEMA-05**: amount TEXT 유지 근거 문서화 [MEDIUM] — ✓ Phase 30
- [x] **SCHEMA-06**: 알림 채널 BEGIN IMMEDIATE 동시성 보호 [MEDIUM] — ✓ Phase 30

## Out of Scope

| Feature | Reason |
|---------|--------|
| 실제 코드 구현 | 설계 보완 마일스톤 — 코드는 v1.0+ |
| v0.5 인증 재설계 재작업 | v0.5에서 완료 |
| v0.6 블록체인 확장 재작업 | v0.6에서 완료 |
| 성능 최적화 | 프로파일링은 구현 후 |
| 새로운 기능 추가 | 기존 설계의 장애 요소 해소만 |
| v0.2 아키텍처 골격 변경 | 6단계 파이프라인, 8-state 머신, 3계층 보안 유지 |

## Traceability

| Requirement | Phase | Status |
|-------------|-------|--------|
| CHAIN-01 | Phase 26 | Complete |
| CHAIN-02 | Phase 26 | Complete |
| CHAIN-03 | Phase 26 | Complete |
| CHAIN-04 | Phase 26 | Complete |
| DAEMON-01 | Phase 27 | Complete |
| DAEMON-02 | Phase 27 | Complete |
| DAEMON-03 | Phase 27 | Complete |
| DAEMON-04 | Phase 27 | Complete |
| DAEMON-05 | Phase 27 | Complete |
| DAEMON-06 | Phase 27 | Complete |
| DEPS-01 | Phase 28 | Complete |
| DEPS-02 | Phase 28 | Complete |
| API-01 | Phase 29 | Complete |
| API-02 | Phase 29 | Complete |
| API-03 | Phase 29 | Complete |
| API-04 | Phase 29 | Complete |
| API-05 | Phase 29 | Complete |
| API-06 | Phase 29 | Complete |
| API-07 | Phase 29 | Complete |
| SCHEMA-01 | Phase 30 | Complete |
| SCHEMA-02 | Phase 30 | Complete |
| SCHEMA-03 | Phase 30 | Complete |
| SCHEMA-04 | Phase 30 | Complete |
| SCHEMA-05 | Phase 30 | Complete |
| SCHEMA-06 | Phase 30 | Complete |

**Coverage:**
- v0.7 requirements: 25 total
- Mapped to phases: 25
- Unmapped: 0

---

## Milestone Summary

**Shipped:** 25 of 25 requirements
**Adjusted:** None — all requirements implemented as originally specified
**Dropped:** None

---
*Archived: 2026-02-08 as part of v0.7 milestone completion*
