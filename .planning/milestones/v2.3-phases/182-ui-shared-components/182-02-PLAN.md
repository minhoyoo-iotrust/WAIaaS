---
phase: 182-ui-shared-components
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/admin/src/components/breadcrumb.tsx
  - packages/admin/src/components/layout.tsx
  - packages/admin/src/styles/global.css
  - packages/admin/src/__tests__/breadcrumb.test.tsx
autonomous: true
requirements: [DESC-01, BCMB-01, BCMB-02, BCMB-03]

must_haves:
  truths:
    - "PageHeader displays a subtitle text below the page title"
    - "Breadcrumb shows 'PageName > TabName' on tabbed pages (Wallets, Sessions, Policies, Notifications, WalletConnect)"
    - "Breadcrumb does NOT appear on Dashboard and System pages"
    - "Clicking the page name in breadcrumb navigates to the first tab"
  artifacts:
    - path: "packages/admin/src/components/breadcrumb.tsx"
      provides: "Breadcrumb navigation component"
      exports: ["Breadcrumb", "BreadcrumbProps"]
    - path: "packages/admin/src/components/layout.tsx"
      provides: "Updated header with subtitle and breadcrumb slot"
      contains: "header-subtitle"
    - path: "packages/admin/src/__tests__/breadcrumb.test.tsx"
      provides: "Tests for Breadcrumb and PageHeader subtitle"
      min_lines: 50
  key_links:
    - from: "packages/admin/src/components/breadcrumb.tsx"
      to: "onPageClick callback prop"
      via: "Page name click triggers onPageClick; Phase 183 will wire to hash navigation"
      pattern: "onPageClick"
---

<objective>
PageHeader에 subtitle 영역을 추가하고 Breadcrumb 컴포넌트를 구축하여, 탭이 있는 페이지에서 현재 위치를 표시한다.

Purpose: 사용자가 현재 페이지의 목적(subtitle)과 탭 내 위치(breadcrumb)를 직관적으로 파악할 수 있게 한다.
Output: breadcrumb.tsx, 수정된 layout.tsx, CSS 추가, 테스트 파일
</objective>

<execution_context>
@/Users/minho.yoo/.claude/get-shit-done/workflows/execute-plan.md
@/Users/minho.yoo/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@packages/admin/src/components/layout.tsx
@packages/admin/src/styles/global.css
</context>

<tasks>

<task type="auto">
  <name>Task 1: PageHeader subtitle 영역 추가 및 Breadcrumb 컴포넌트 생성</name>
  <files>
    packages/admin/src/components/breadcrumb.tsx
    packages/admin/src/components/layout.tsx
    packages/admin/src/styles/global.css
  </files>
  <action>
1. **Breadcrumb 컴포넌트** (`packages/admin/src/components/breadcrumb.tsx`):
   - `BreadcrumbProps` 인터페이스: `{ pageName: string; tabName?: string; onPageClick?: () => void }` 정의
   - tabName이 없으면 null 반환 (breadcrumb 미표시 -- Dashboard/System 대응)
   - 렌더링 구조:
     ```
     <nav class="breadcrumb" aria-label="Breadcrumb">
       <button class="breadcrumb-page" onClick={onPageClick} type="button">
         {pageName}
       </button>
       <span class="breadcrumb-separator" aria-hidden="true">&gt;</span>
       <span class="breadcrumb-current" aria-current="page">{tabName}</span>
     </nav>
     ```
   - `Breadcrumb`, `BreadcrumbProps`를 named export

2. **Layout.tsx PageHeader subtitle 추가** (`packages/admin/src/components/layout.tsx`):
   - `PAGE_SUBTITLES` Record 추가 (PAGE_TITLES 아래):
     ```typescript
     const PAGE_SUBTITLES: Record<string, string> = {
       '/dashboard': 'System overview and key metrics',
       '/wallets': 'Manage wallets, balances, and connections',
       '/sessions': 'View and manage active sessions',
       '/policies': 'Configure transaction policies and rules',
       '/notifications': 'Channel status, delivery logs, and settings',
       '/walletconnect': 'WalletConnect session management',
       '/settings': 'System configuration and preferences',
     };
     ```
   - `getPageSubtitle(path: string): string | undefined` 함수 추가: `PAGE_SUBTITLES[path]` 반환 (wallet detail 등은 undefined)
   - header 구조 변경:
     ```tsx
     <header class="header">
       <div class="header-left">
         <h1 class="header-title">{getPageTitle(currentPath.value)}</h1>
         {getPageSubtitle(currentPath.value) && (
           <p class="header-subtitle">{getPageSubtitle(currentPath.value)}</p>
         )}
       </div>
       <button class="btn-logout" onClick={() => logout()}>Logout</button>
     </header>
     ```
   - header의 height를 `auto`로 변경하고 `min-height: var(--header-height)`로 대체 (subtitle이 들어가면 높이 증가 필요)

3. **CSS 추가** (`packages/admin/src/styles/global.css`):
   - `.header` 수정: `height` -> `min-height: var(--header-height);` + `padding: var(--space-2) var(--space-6);` 추가
   - `.header-left` 추가: `display: flex; flex-direction: column; justify-content: center; gap: 0;`
   - `.header-subtitle` 추가: `font-size: var(--font-size-xs); color: var(--color-text-secondary); font-weight: var(--font-weight-normal); margin: 0;`
   - `.breadcrumb` 추가: `display: flex; align-items: center; gap: var(--space-1); font-size: var(--font-size-xs); color: var(--color-text-secondary); margin-bottom: var(--space-2);` (content 영역 내부, tab-nav 위에 배치할 수 있도록)
   - `.breadcrumb-page` 추가: `background: none; border: none; color: var(--color-primary); cursor: pointer; font-size: inherit; padding: 0; font-family: inherit;`
   - `.breadcrumb-page:hover` 추가: `text-decoration: underline;`
   - `.breadcrumb-separator` 추가: `color: var(--color-text-muted);`
   - `.breadcrumb-current` 추가: `color: var(--color-text-secondary); font-weight: var(--font-weight-medium);`

NOTE: Breadcrumb 컴포넌트는 이 plan에서는 생성만 하고, 실제 페이지에 적용하는 것은 Phase 183에서 각 페이지에 TabNav를 적용할 때 함께 적용한다. 이 plan에서는 컴포넌트 + 테스트만 준비한다. Layout.tsx에는 subtitle만 추가한다.
  </action>
  <verify>
    `cd /Users/minho.yoo/dev/wallet/WAIaaS && pnpm turbo run typecheck --filter=@waiaas/admin` 통과 확인
  </verify>
  <done>
    - breadcrumb.tsx가 Breadcrumb/BreadcrumbProps를 export한다
    - layout.tsx header에 subtitle 영역이 추가되었다
    - 7개 페이지에 대한 subtitle 텍스트가 PAGE_SUBTITLES에 정의되었다
    - CSS에 breadcrumb, header-subtitle 스타일이 추가되었다
  </done>
</task>

<task type="auto">
  <name>Task 2: Breadcrumb + PageHeader subtitle 테스트 작성</name>
  <files>packages/admin/src/__tests__/breadcrumb.test.tsx</files>
  <action>
기존 테스트 패턴을 참고하여 `breadcrumb.test.tsx` 작성.

1. **Breadcrumb 컴포넌트 테스트** (`describe('Breadcrumb')`):
   - `it('renders breadcrumb with page name and tab name')`: pageName='Wallets', tabName='Overview' -> 'Wallets', '>', 'Overview' 텍스트 확인
   - `it('returns null when tabName is not provided')`: tabName 없이 -> container에 아무 것도 렌더링되지 않음 확인 (`container.innerHTML`이 비어있음)
   - `it('calls onPageClick when page name is clicked')`: 'Wallets' 버튼 클릭 -> onPageClick 호출 확인
   - `it('has correct aria attributes')`: aria-label="Breadcrumb" 확인, aria-current="page" 확인
   - `it('does not render for Dashboard-like usage')`: tabName 미전달 -> null 반환으로 BCMB-02 검증

2. **PageHeader subtitle 테스트** (`describe('PageHeader subtitle')`):
   - Layout 컴포넌트를 직접 테스트하기보다, `PAGE_SUBTITLES` 데이터와 `getPageSubtitle` 함수를 export하여 단위 테스트.
   - Layout.tsx에서 `getPageSubtitle`을 named export로 추가하고 테스트:
     - `it('returns subtitle for dashboard')`: getPageSubtitle('/dashboard') -> truthy 확인
     - `it('returns subtitle for all 7 main pages')`: 7개 경로 모두 truthy 확인
     - `it('returns undefined for unknown path')`: getPageSubtitle('/unknown') -> undefined 확인
     - `it('returns undefined for wallet detail path')`: getPageSubtitle('/wallets/123') -> undefined 확인

모든 테스트에서 `@testing-library/preact`의 `render`, `screen`, `fireEvent` 사용. `vi.fn()` 으로 콜백 모킹.

NOTE: Layout 전체 렌더링 테스트는 다수의 모킹이 필요하므로 피하고, Breadcrumb 단독 테스트 + getPageSubtitle 단위 테스트로 충분한 커버리지를 확보한다.
  </action>
  <verify>
    `cd /Users/minho.yoo/dev/wallet/WAIaaS && pnpm turbo run test --filter=@waiaas/admin -- --run packages/admin/src/__tests__/breadcrumb.test.tsx` 전체 통과 확인
  </verify>
  <done>
    - Breadcrumb 5개 테스트 통과 (렌더링, null 반환, 클릭 콜백, aria 속성, Dashboard 미표시)
    - PageHeader subtitle 4개 테스트 통과 (단일 경로, 7개 전체, 미지정 경로, 상세 경로)
  </done>
</task>

</tasks>

<verification>
1. `pnpm turbo run typecheck --filter=@waiaas/admin` 통과
2. `pnpm turbo run test --filter=@waiaas/admin -- --run packages/admin/src/__tests__/breadcrumb.test.tsx` 전체 통과
3. `pnpm turbo run lint --filter=@waiaas/admin` 통과
4. Layout.tsx의 header에 subtitle이 렌더링됨을 typecheck로 확인
</verification>

<success_criteria>
1. PageHeader에 subtitle 텍스트가 표시된다 (7개 페이지 모두 정의)
2. Breadcrumb 컴포넌트가 pageName > tabName 형태로 렌더링된다
3. tabName이 없으면 Breadcrumb가 렌더링되지 않는다 (Dashboard/System 대응)
4. pageName 클릭 시 onPageClick 콜백이 호출된다
5. 9개 테스트가 모두 통과한다
</success_criteria>

<output>
After completion, create `.planning/phases/182-ui-shared-components/182-02-SUMMARY.md`
</output>
