# Roadmap: WAIaaS

## Milestones

- ✅ **v0.1 Research & Design** — Phases 1-5 (shipped 2026-02-05)
- ✅ **v0.2 Self-Hosted Secure Wallet Design** — Phases 6-9 (shipped 2026-02-05)
- ✅ **v0.3 설계 논리 일관성 확보** — Phases 10-13 (shipped 2026-02-06)
- ✅ **v0.4 테스트 전략 및 계획 수립** — Phases 14-18 (shipped 2026-02-07)
- ✅ **v0.5 인증 모델 재설계 + DX 개선** — Phases 19-21 (shipped 2026-02-07)
- ✅ **v0.6 블록체인 기능 확장 설계** — Phases 22-25 (shipped 2026-02-08)
- ✅ **v0.7 구현 장애 요소 해소** — Phases 26-30 (shipped 2026-02-08)
- ✅ **v0.8 Owner 선택적 등록 + 점진적 보안** — Phases 31-35 (shipped 2026-02-09)
- ✅ **v0.9 MCP 세션 관리 자동화 설계** — Phases 36-40 (shipped 2026-02-09)
- ✅ **v0.10 구현 전 설계 완결성 확보** — Phases 41-44 (shipped 2026-02-09)
- ✅ **v1.0 구현 계획 수립** — Phases 45-47 (shipped 2026-02-09)
- **v1.1 코어 인프라 + 기본 전송** — Phases 48-51 (in progress)

## Phases

<details>
<summary>v0.1 Research & Design (Phases 1-5) -- SHIPPED 2026-02-05</summary>

- [x] Phase 1: AI 에이전트 지갑 요구사항 분석 (3 plans)
- [x] Phase 2: 커스터디 모델 비교 연구 (3 plans)
- [x] Phase 3: Solana 기술 스택 조사 (3 plans)
- [x] Phase 4: 주인-에이전트 관계 모델 설계 (3 plans)
- [x] Phase 5: 오픈소스/기존 솔루션 조사 + 에이전트 프레임워크 통합 (3 plans)

</details>

<details>
<summary>v0.2 Self-Hosted Secure Wallet Design (Phases 6-9) -- SHIPPED 2026-02-05</summary>

- [x] Phase 6: 코어 지갑 서비스 설계 (4 plans)
- [x] Phase 7: 세션 + 체인 추상화 설계 (4 plans)
- [x] Phase 8: 보안 계층 설계 (4 plans)
- [x] Phase 9: 통합 + 배포 설계 (4 plans)

</details>

<details>
<summary>v0.3 설계 논리 일관성 확보 (Phases 10-13) -- SHIPPED 2026-02-06</summary>

- [x] Phase 10: v0.1 잔재 정리 + 변경 매핑 (2 plans)
- [x] Phase 11: CRITICAL 의사결정 확정 (2 plans)
- [x] Phase 12: Enum/상태값 통합 대응표 (2 plans)
- [x] Phase 13: REST API<>Framework 스펙 통일 (2 plans)

</details>

<details>
<summary>v0.4 테스트 전략 및 계획 수립 (Phases 14-18) -- SHIPPED 2026-02-07</summary>

- [x] Phase 14: 테스트 레벨/매트릭스/커버리지 정의 (2 plans)
- [x] Phase 15: 보안 공격 시나리오 71건 (2 plans)
- [x] Phase 16: 블록체인 3단계 테스트 환경 (2 plans)
- [x] Phase 17: CI/CD 4단계 파이프라인 (1 plan)
- [x] Phase 18: 배포 타겟별 테스트 시나리오 (2 plans)

</details>

<details>
<summary>v0.5 인증 모델 재설계 + DX 개선 (Phases 19-21) -- SHIPPED 2026-02-07</summary>

- [x] Phase 19: 3-Tier 인증 모델 재설계 (3 plans)
- [x] Phase 20: 세션 낙관적 갱신 + CLI DX (3 plans)
- [x] Phase 21: 기존 설계 문서 11개 v0.5 통합 (3 plans)

</details>

<details>
<summary>v0.6 블록체인 기능 확장 설계 (Phases 22-25) -- SHIPPED 2026-02-08</summary>

- [x] Phase 22: 토큰 확장 + 정책 (3 plans)
- [x] Phase 23: 트랜잭션 타입 확장 (3 plans)
- [x] Phase 24: 상위 추상화 레이어 (3 plans)
- [x] Phase 25: 테스트 전략 통합 + 문서 통합 (2 plans)

</details>

<details>
<summary>v0.7 구현 장애 요소 해소 (Phases 26-30) -- SHIPPED 2026-02-08</summary>

- [x] Phase 26: 체인 어댑터 안정화 (2 plans)
- [x] Phase 27: 데몬 보안 기반 확립 (3 plans)
- [x] Phase 28: 의존성 빌드 환경 해소 (2 plans)
- [x] Phase 29: API 통합 프로토콜 완성 (2 plans)
- [x] Phase 30: 스키마 설정 확정 (2 plans)

</details>

<details>
<summary>v0.8 Owner 선택적 등록 + 점진적 보안 (Phases 31-35) -- SHIPPED 2026-02-09</summary>

- [x] Phase 31: Owner 선택적 데이터 모델 (2 plans)
- [x] Phase 32: Owner 생명주기 상태 머신 (3 plans)
- [x] Phase 33: 정책 다운그레이드 메커니즘 (2 plans)
- [x] Phase 34: 자금 회수 프로토콜 (2 plans)
- [x] Phase 35: DX + 설계 문서 통합 (2 plans)

</details>

<details>
<summary>v0.9 MCP 세션 관리 자동화 설계 (Phases 36-40) -- SHIPPED 2026-02-09</summary>

- [x] Phase 36: 토큰 파일 인프라 (2 plans)
- [x] Phase 37: SessionManager 핵심 설계 (2 plans)
- [x] Phase 38: MCP 통합 설계 (2 plans)
- [x] Phase 39: CLI + Telegram 연동 (2 plans)
- [x] Phase 40: 테스트 설계 + 문서 통합 (2 plans)

</details>

<details>
<summary>v0.10 구현 전 설계 완결성 확보 (Phases 41-44) -- SHIPPED 2026-02-09</summary>

- [x] Phase 41: 정책 엔진 완결 (2 plans)
- [x] Phase 42: 에러 처리 체계 완결 (2 plans)
- [x] Phase 43: 동시성 + 실행 로직 완결 (3 plans)
- [x] Phase 44: 운영 로직 완결 (3 plans)

</details>

<details>
<summary>v1.0 구현 계획 수립 (Phases 45-47) -- SHIPPED 2026-02-09</summary>

- [x] Phase 45: 코어 구현 objective 문서 생성 (2 plans)
- [x] Phase 46: 확장 + 릴리스 objective 문서 생성 (2 plans)
- [x] Phase 47: 설계 부채 + 로드맵 최종 검증 (1 plan)

</details>

### v1.1 코어 인프라 + 기본 전송 (In Progress)

**마일스톤 목표:** CLI로 init -> start -> SOL 전송 -> 확인까지 동작하는 최소 데몬

- [x] **Phase 48: 모노레포 스캐폴드 + @waiaas/core** — 빌드 인프라와 공유 타입/스키마/인터페이스 패키지 (completed 2026-02-10)
- [ ] **Phase 49: 데몬 인프라** — SQLite, 키스토어, config 로더, 라이프사이클
- [ ] **Phase 50: API 서버 + SolanaAdapter + 파이프라인** — HTTP 엔드포인트, 체인 연동, 트랜잭션 실행
- [ ] **Phase 51: CLI + E2E 통합 검증** — 사용자 CLI와 전 구간 자동 검증

## Phase Details

### Phase 48: 모노레포 스캐폴드 + @waiaas/core

**목표**: 4개 패키지가 빌드-테스트-린트 파이프라인으로 연결되고, 모든 다운스트림 패키지가 import할 공유 타입/스키마/에러/인터페이스가 준비된다
**의존**: 없음 (첫 번째 구현 페이즈)
**요구사항**: MONO-01, MONO-02, MONO-03, CORE-01, CORE-02, CORE-03, CORE-04, CORE-05
**성공 기준** (페이즈 완료 시 참이어야 하는 것):
  1. `pnpm install && pnpm build && pnpm test && pnpm lint`가 루트에서 한 번에 성공한다
  2. `@waiaas/core`를 다른 패키지에서 import하면 12개 Enum, Zod 스키마, 66개 에러 코드, 4개 인터페이스에 대한 타입 추론이 IDE에서 동작한다
  3. WAIaaSError를 throw하고 catch하면 에러 코드(code)와 HTTP 상태(httpStatus)를 프로그래밍적으로 조회할 수 있다
  4. `getMessages('ko')` 호출 시 한글 메시지 객체가 반환되고, `getMessages('en')` 호출 시 영문 메시지 객체가 반환된다
  5. Enum 값과 Zod 스키마가 일치하는지 검증하는 단위 테스트가 통과한다
**플랜**: 3 plans

Plans:
- [ ] 48-01-PLAN.md — 모노레포 스캐폴드 (pnpm workspace, Turborepo, tsconfig, ESLint flat config, Prettier, Vitest workspace, .nvmrc, 4개 패키지 셸)
- [ ] 48-02-PLAN.md — @waiaas/core Enum SSoT 12개 + Zod 스키마 5개 + 에러 코드 66개 + WAIaaSError (TDD)
- [ ] 48-03-PLAN.md — @waiaas/core 인터페이스 4개 + i18n (en/ko) + 패키지 전체 빌드/export 검증 (TDD)

### Phase 49: 데몬 인프라

**목표**: @waiaas/daemon 패키지가 SQLite DB, 키스토어, config 로더, 데몬 라이프사이클을 갖추어 "시작-실행-종료"가 가능한 프로세스가 된다
**의존**: Phase 48 (@waiaas/core 타입/스키마/인터페이스)
**요구사항**: DB-01, DB-02, DB-03, KEY-01, KEY-02, KEY-03, CFG-01, CFG-02, LIFE-01, LIFE-02, LIFE-03, LIFE-04
**성공 기준** (페이즈 완료 시 참이어야 하는 것):
  1. 데몬이 시작되면 7개 테이블이 생성되고 PRAGMA 7개가 적용된 SQLite DB 파일이 존재한다
  2. 마스터 패스워드로 에이전트 개인키를 암호화 저장한 후, 같은 패스워드로 복호화하면 원본 키와 일치하며, 틀린 패스워드로는 복호화가 실패한다
  3. config.toml 파일의 값이 로드되고, 같은 키에 환경변수가 설정되어 있으면 환경변수 값이 우선한다
  4. 데몬 프로세스를 시작한 후 SIGTERM을 보내면 WAL 체크포인트 완료 후 정상 종료되고, PID 파일이 제거된다
  5. 이미 실행 중인 데몬이 있을 때 두 번째 인스턴스를 시작하면 flock 잠금 충돌로 즉시 실패한다
**플랜**: 3 plans

Plans:
- [ ] 49-01-PLAN.md — SQLite 7-table Drizzle ORM 스키마 + PRAGMA 7개 + UUID v7 + CHECK 제약 (TDD, Wave 1)
- [ ] 49-02-PLAN.md — AES-256-GCM 키스토어 + Argon2id KDF + sodium guarded memory + 파일 포맷 v1 (TDD, Wave 1)
- [ ] 49-03-PLAN.md — config.toml 로더 (smol-toml + Zod) + 데몬 라이프사이클 (6-step 시작/10-step 종료/flock/PID/BackgroundWorkers) (TDD, Wave 2)

### Phase 50: API 서버 + SolanaAdapter + 파이프라인

**목표**: HTTP로 에이전트를 생성하고 SOL 잔액 조회와 전송을 요청하면, SolanaAdapter가 온체인 트랜잭션을 실행하고 확정 상태까지 추적된다
**의존**: Phase 49 (데몬 인프라 — DB, 키스토어, 라이프사이클)
**요구사항**: API-01, API-02, API-03, API-04, API-05, API-06, API-07, API-08, SOL-01, SOL-02, SOL-03, SOL-04, SOL-05, SOL-06, PIPE-01, PIPE-02, PIPE-03, PIPE-04
**성공 기준** (페이즈 완료 시 참이어야 하는 것):
  1. `curl http://127.0.0.1:3100/health`가 200 OK를 반환하고, 외부 IP에서의 요청은 hostGuard에 의해 거부된다
  2. `POST /v1/agents`로 에이전트를 생성하면 Solana 키 쌍이 생성-암호화 저장되고, `GET /v1/wallet/address`로 base58 공개키를 조회할 수 있다
  3. `GET /v1/wallet/balance`가 Solana RPC에서 조회한 실제 SOL 잔액을 lamports 단위로 반환한다
  4. `POST /v1/transactions/send`로 SOL 전송을 요청하면 파이프라인 6-stage를 거쳐 온체인에 제출되고, `GET /v1/transactions/:id` 폴링으로 CONFIRMED 상태를 확인할 수 있다
  5. 존재하지 않는 에이전트 ID로 API를 호출하면 WAIaaSError 기반 404 JSON 응답이 반환된다
**플랜**: TBD

Plans:
- [ ] 50-01: Hono API 서버 프레임워크 + 미들웨어 6개 + health 엔드포인트
- [ ] 50-02: SolanaAdapter 6개 메서드 (@solana/kit 3.x, connect~waitForConfirmation)
- [ ] 50-03: 에이전트/지갑 API 라우트 (POST /v1/agents, GET /v1/wallet/balance, GET /v1/wallet/address)
- [ ] 50-04: 트랜잭션 파이프라인 6-stage + 전송 API (POST /v1/transactions/send, GET /v1/transactions/:id)

### Phase 51: CLI + E2E 통합 검증

**목표**: 사용자가 CLI만으로 init -> start -> SOL 전송 -> 확인까지 완수할 수 있고, 12건의 자동화된 E2E 테스트가 전 구간을 검증한다
**의존**: Phase 50 (API 서버 + SolanaAdapter + 파이프라인)
**요구사항**: CLI-01, CLI-02, CLI-03, CLI-04, E2E-01, E2E-02, E2E-03, E2E-04
**성공 기준** (페이즈 완료 시 참이어야 하는 것):
  1. `waiaas init`을 실행하면 `~/.waiaas/` 디렉토리, config.toml 기본값, keystore/ 디렉토리가 생성된다
  2. `waiaas start`로 데몬을 기동한 후 `waiaas status`가 `running` + 포트 3100을 표시하고, `waiaas stop`으로 종료하면 `stopped`로 전환된다
  3. 데몬 실행 중 `POST /v1/agents` -> `POST /v1/transactions/send` -> `GET /v1/transactions/:id` 폴링으로 SOL 전송이 CONFIRMED까지 완료된다
  4. E2E 테스트 12건(라이프사이클 4 + 에이전트 3 + 트랜잭션 2 + 에러 3)이 모두 자동으로 통과한다
**플랜**: TBD

Plans:
- [ ] 51-01: CLI 4개 명령어 (init, start, stop, status)
- [ ] 51-02: E2E 테스트 12건 (라이프사이클 + 에이전트 + 트랜잭션 + 에러)

## Progress

**실행 순서:** Phase 48 -> 49 -> 50 -> 51

| Milestone | Phases | Plans | Status | Shipped |
|-----------|--------|-------|--------|---------|
| v0.1 Research & Design | 1-5 | 15 | Complete | 2026-02-05 |
| v0.2 Self-Hosted Design | 6-9 | 16 | Complete | 2026-02-05 |
| v0.3 설계 일관성 | 10-13 | 8 | Complete | 2026-02-06 |
| v0.4 테스트 전략 | 14-18 | 9 | Complete | 2026-02-07 |
| v0.5 인증 재설계 | 19-21 | 9 | Complete | 2026-02-07 |
| v0.6 블록체인 확장 | 22-25 | 11 | Complete | 2026-02-08 |
| v0.7 장애 요소 해소 | 26-30 | 11 | Complete | 2026-02-08 |
| v0.8 Owner 선택적 등록 | 31-35 | 11 | Complete | 2026-02-09 |
| v0.9 MCP 세션 자동화 | 36-40 | 10 | Complete | 2026-02-09 |
| v0.10 설계 완결성 | 41-44 | 10 | Complete | 2026-02-09 |
| v1.0 구현 계획 수립 | 45-47 | 5 | Complete | 2026-02-09 |
| **v1.1 코어 인프라** | **48-51** | **3/12** | **In progress** | - |

**Total:** 11 milestones shipped, 47 phases, 115 plans completed + v1.1 진행 중 (4 phases, 12 plans)

---

*Last updated: 2026-02-10 after v1.1 roadmap created*
